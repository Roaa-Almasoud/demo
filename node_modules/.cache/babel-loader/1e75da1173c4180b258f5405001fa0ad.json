{"ast":null,"code":"var Node = require('../document/Node');\n\nvar Metric = require('../../component/Metric');\n\nvar CSS = require('../document/CSS');\n\nvar DocumentEvent = require('../document/DocumentEvent'),\n    NodeEvent = require('../document/NodeEvent');\n\nvar Mouse = require('../document/Mouse');\n\nfunction ScrollBar(parentNode, targetNode, wrapHeight) {\n  this._parentNode = parentNode;\n  this._targetNode = targetNode;\n  this._wrapHeight = wrapHeight;\n  var wrap = this._wrapNode = new Node().setStyleClass(CSS.ScrollWrap),\n      node = this._node = new Node().setStyleClass(CSS.ScrollBar),\n      track = this._trackNode = new Node().setStyleClass(CSS.ScrollBarTrack),\n      thumb = this._thumbNode = new Node().setStyleClass(CSS.ScrollBarThumb);\n  parentNode.removeChild(targetNode);\n  parentNode.addChild(wrap);\n  parentNode.addChildAt(node, 0);\n  wrap.addChild(targetNode);\n  node.addChild(track);\n  track.addChild(thumb);\n  this._mouseThumbOffset = 0;\n  this._scrollHeight = 0;\n  this._scrollUnit = 0;\n  this._scrollMin = 0;\n  this._scrollMax = 0;\n  thumb.setPositionY(Metric.SCROLLBAR_TRACK_PADDING);\n  thumb.addEventListener(DocumentEvent.MOUSE_DOWN, this._onThumbDragStart.bind(this));\n  this._isValid = false;\n  this._enabled = false;\n  var nodeElement = node.getElement(),\n      thumbElement = thumb.getElement();\n  var self = this;\n\n  this._onMouseWheel = function (e) {\n    var sender = e.sender,\n        hoverElement = sender.getHoverElement();\n\n    if (hoverElement != nodeElement && hoverElement != thumbElement) {\n      return;\n    }\n\n    var scrollStep = self._scrollHeight * 0.0125;\n\n    self._scroll(thumb.getPositionY() + sender.getWheelDirection() * scrollStep * -1);\n\n    e.data.preventDefault();\n  };\n\n  this.addMouseListener();\n}\n\nScrollBar.prototype.update = function () {\n  var target = this._targetNode,\n      thumb = this._thumbNode;\n  var padding = Metric.SCROLLBAR_TRACK_PADDING;\n  var targetWrapHeight = this._wrapHeight,\n      targetHeight = target.getHeight(),\n      trackHeight = targetWrapHeight - padding * 2;\n  thumb.setHeight(trackHeight);\n  var ratio = targetWrapHeight / targetHeight;\n  this._isValid = false;\n\n  if (ratio > 1.0) {\n    return;\n  }\n\n  var thumbHeight = trackHeight * ratio;\n  this._scrollHeight = trackHeight;\n  this._scrollUnit = targetHeight - this._scrollHeight - padding * 2;\n  this._scrollMin = padding;\n  this._scrollMax = padding + trackHeight - thumbHeight;\n  thumb.setHeight(thumbHeight);\n  this._isValid = true;\n};\n\nScrollBar.prototype._scroll = function (y) {\n  var min = this._scrollMin,\n      max = this._scrollMax,\n      pos = Math.max(min, Math.min(y, max)),\n      pos_ = (pos - min) / (max - min);\n\n  this._thumbNode.setPositionY(pos);\n\n  this._targetNode.setPositionY(pos_ * this._scrollUnit * -1);\n};\n\nScrollBar.prototype._onThumbDragStart = function () {\n  if (!this._isValid || this._enabled) {\n    return;\n  }\n\n  var eventMove = DocumentEvent.MOUSE_MOVE,\n      eventUp = DocumentEvent.MOUSE_UP;\n  var mouse = Mouse.get();\n\n  var trackOffset = this._trackNode.getPositionGlobalY();\n\n  this._mouseThumbOffset = mouse.getY() - this._thumbNode.getPositionGlobalY();\n  var self = this;\n\n  var onDrag = function onDrag() {\n    self._scroll(mouse.getY() - trackOffset - self._mouseThumbOffset);\n  },\n      onDragEnd = function onDragEnd() {\n    document.removeEventListener(eventMove, onDrag, false);\n    document.removeEventListener(eventUp, onDragEnd, false);\n  };\n\n  document.addEventListener(eventMove, onDrag, false);\n  document.addEventListener(eventUp, onDragEnd, false);\n\n  this._scroll(mouse.getY() - trackOffset - self._mouseThumbOffset);\n};\n\nScrollBar.prototype.enable = function () {\n  this._enabled = false;\n\n  this._updateAppearance();\n};\n\nScrollBar.prototype.disable = function () {\n  this._enabled = true;\n\n  this._updateAppearance();\n};\n\nScrollBar.prototype.reset = function () {\n  this._scroll(0);\n};\n\nScrollBar.prototype._updateAppearance = function () {\n  if (this._enabled) {\n    this._node.setStyleProperty('display', 'none');\n\n    this._targetNode.setPositionY(0);\n\n    this._thumbNode.setPositionY(Metric.SCROLLBAR_TRACK_PADDING);\n  } else {\n    this._node.setStyleProperty('display', 'block');\n  }\n};\n\nScrollBar.prototype.isValid = function () {\n  return this._isValid;\n};\n\nScrollBar.prototype.setWrapHeight = function (height) {\n  this._wrapHeight = height;\n  this.update();\n};\n\nScrollBar.prototype.removeTargetNode = function () {\n  return this._wrapNode.removeChild(this._targetNode);\n};\n\nScrollBar.prototype.removeMouseListener = function () {\n  Mouse.get().removeEventListener(DocumentEvent.MOUSE_WHEEL, this, '_onMouseWheel');\n};\n\nScrollBar.prototype.addMouseListener = function () {\n  Mouse.get().addEventListener(DocumentEvent.MOUSE_WHEEL, this, '_onMouseWheel');\n};\n\nScrollBar.prototype.removeFromParent = function () {\n  var parentNode = this._parentNode,\n      rootNode = this._node,\n      targetNode = this._targetNode;\n  rootNode.removeChild(targetNode);\n  parentNode.removeChild(this._wrapNode);\n  parentNode.removeChild(rootNode);\n  return targetNode;\n};\n\nScrollBar.prototype.getWrapNode = function () {\n  return this._wrapNode;\n};\n\nScrollBar.prototype.getNode = function () {\n  return this._node;\n};\n\nScrollBar.prototype.getTargetNode = function () {\n  return this._targetNode;\n};\n\nmodule.exports = ScrollBar;","map":{"version":3,"sources":["/Users/roaa/Desktop/demo/node_modules/@brunoimbrizi/controlkit/lib/core/layout/ScrollBar.js"],"names":["Node","require","Metric","CSS","DocumentEvent","NodeEvent","Mouse","ScrollBar","parentNode","targetNode","wrapHeight","_parentNode","_targetNode","_wrapHeight","wrap","_wrapNode","setStyleClass","ScrollWrap","node","_node","track","_trackNode","ScrollBarTrack","thumb","_thumbNode","ScrollBarThumb","removeChild","addChild","addChildAt","_mouseThumbOffset","_scrollHeight","_scrollUnit","_scrollMin","_scrollMax","setPositionY","SCROLLBAR_TRACK_PADDING","addEventListener","MOUSE_DOWN","_onThumbDragStart","bind","_isValid","_enabled","nodeElement","getElement","thumbElement","self","_onMouseWheel","e","sender","hoverElement","getHoverElement","scrollStep","_scroll","getPositionY","getWheelDirection","data","preventDefault","addMouseListener","prototype","update","target","padding","targetWrapHeight","targetHeight","getHeight","trackHeight","setHeight","ratio","thumbHeight","y","min","max","pos","Math","pos_","eventMove","MOUSE_MOVE","eventUp","MOUSE_UP","mouse","get","trackOffset","getPositionGlobalY","getY","onDrag","onDragEnd","document","removeEventListener","enable","_updateAppearance","disable","reset","setStyleProperty","isValid","setWrapHeight","height","removeTargetNode","removeMouseListener","MOUSE_WHEEL","removeFromParent","rootNode","getWrapNode","getNode","getTargetNode","module","exports"],"mappings":"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","sourcesContent":["var Node   = require('../document/Node');\r\nvar Metric = require('../../component/Metric');\r\nvar CSS    = require('../document/CSS');\r\nvar DocumentEvent = require('../document/DocumentEvent'),\r\n    NodeEvent     = require('../document/NodeEvent');\r\nvar Mouse  = require('../document/Mouse');\r\n\r\nfunction ScrollBar(parentNode,targetNode,wrapHeight) {\r\n    this._parentNode = parentNode;\r\n    this._targetNode = targetNode;\r\n    this._wrapHeight = wrapHeight;\r\n\r\n    var wrap   = this._wrapNode   = new Node().setStyleClass(CSS.ScrollWrap),\r\n        node   = this._node       = new Node().setStyleClass(CSS.ScrollBar),\r\n        track  = this._trackNode  = new Node().setStyleClass(CSS.ScrollBarTrack),\r\n        thumb  = this._thumbNode  = new Node().setStyleClass(CSS.ScrollBarThumb);\r\n\r\n    parentNode.removeChild(targetNode);\r\n    parentNode.addChild(wrap);\r\n    parentNode.addChildAt(node,0);\r\n\r\n    wrap.addChild(targetNode);\r\n    node.addChild(track);\r\n    track.addChild(thumb);\r\n\r\n    this._mouseThumbOffset = 0;\r\n    this._scrollHeight = 0;\r\n    this._scrollUnit   = 0;\r\n    this._scrollMin    = 0;\r\n    this._scrollMax    = 0;\r\n\r\n    thumb.setPositionY(Metric.SCROLLBAR_TRACK_PADDING);\r\n    thumb.addEventListener(DocumentEvent.MOUSE_DOWN,this._onThumbDragStart.bind(this));\r\n\r\n    this._isValid  = false;\r\n    this._enabled = false;\r\n\r\n    var nodeElement = node.getElement(),\r\n        thumbElement = thumb.getElement();\r\n    var self = this;\r\n    this._onMouseWheel = function(e){\r\n        var sender = e.sender,\r\n            hoverElement = sender.getHoverElement();\r\n        if(hoverElement != nodeElement && hoverElement != thumbElement){\r\n            return;\r\n        }\r\n        var scrollStep = self._scrollHeight * 0.0125;\r\n        self._scroll(thumb.getPositionY() + sender.getWheelDirection() * scrollStep * -1);\r\n        e.data.preventDefault();\r\n    };\r\n\r\n    this.addMouseListener();\r\n}\r\n\r\nScrollBar.prototype.update = function(){\r\n    var target = this._targetNode,\r\n        thumb = this._thumbNode;\r\n\r\n    var padding = Metric.SCROLLBAR_TRACK_PADDING;\r\n\r\n    var targetWrapHeight = this._wrapHeight,\r\n        targetHeight = target.getHeight(),\r\n        trackHeight = targetWrapHeight - padding * 2;\r\n\r\n    thumb.setHeight(trackHeight);\r\n\r\n    var ratio = targetWrapHeight / targetHeight;\r\n\r\n    this._isValid = false;\r\n\r\n    if (ratio > 1.0){\r\n        return;\r\n    }\r\n    var thumbHeight = trackHeight * ratio;\r\n\r\n    this._scrollHeight = trackHeight;\r\n    this._scrollUnit   = targetHeight - this._scrollHeight - padding * 2;\r\n    this._scrollMin    = padding;\r\n    this._scrollMax    = padding + trackHeight - thumbHeight;\r\n\r\n    thumb.setHeight(thumbHeight);\r\n\r\n    this._isValid = true;\r\n};\r\n\r\nScrollBar.prototype._scroll = function(y){\r\n    var min  = this._scrollMin,\r\n        max  = this._scrollMax,\r\n        pos  = Math.max(min, Math.min(y,max)),\r\n        pos_ = (pos-min)/(max-min);\r\n\r\n    this._thumbNode.setPositionY(pos);\r\n    this._targetNode.setPositionY(pos_ * this._scrollUnit * -1);\r\n};\r\n\r\n\r\nScrollBar.prototype._onThumbDragStart = function () {\r\n    if (!this._isValid || this._enabled){\r\n        return;\r\n    }\r\n    var eventMove = DocumentEvent.MOUSE_MOVE,\r\n        eventUp = DocumentEvent.MOUSE_UP;\r\n\r\n    var mouse = Mouse.get();\r\n    var trackOffset = this._trackNode.getPositionGlobalY();\r\n\r\n    this._mouseThumbOffset = mouse.getY() - this._thumbNode.getPositionGlobalY();\r\n\r\n    var self = this;\r\n    var onDrag = function () {\r\n            self._scroll(mouse.getY() - trackOffset - self._mouseThumbOffset);\r\n        },\r\n        onDragEnd = function () {\r\n            document.removeEventListener(eventMove, onDrag, false);\r\n            document.removeEventListener(eventUp, onDragEnd, false);\r\n        };\r\n\r\n    document.addEventListener(eventMove, onDrag, false);\r\n    document.addEventListener(eventUp, onDragEnd, false);\r\n    this._scroll(mouse.getY() - trackOffset - self._mouseThumbOffset);\r\n};\r\n\r\n\r\nScrollBar.prototype.enable = function () {\r\n    this._enabled = false;\r\n    this._updateAppearance();\r\n};\r\n\r\nScrollBar.prototype.disable = function () {\r\n    this._enabled = true;\r\n    this._updateAppearance();\r\n};\r\nScrollBar.prototype.reset = function () {\r\n    this._scroll(0);\r\n};\r\n\r\nScrollBar.prototype._updateAppearance = function () {\r\n    if (this._enabled) {\r\n        this._node.setStyleProperty('display', 'none');\r\n        this._targetNode.setPositionY(0);\r\n        this._thumbNode.setPositionY(Metric.SCROLLBAR_TRACK_PADDING);\r\n    } else {\r\n        this._node.setStyleProperty('display', 'block');\r\n    }\r\n};\r\n\r\nScrollBar.prototype.isValid = function () {\r\n    return this._isValid;\r\n};\r\n\r\nScrollBar.prototype.setWrapHeight = function (height) {\r\n    this._wrapHeight = height;\r\n    this.update();\r\n};\r\n\r\nScrollBar.prototype.removeTargetNode = function () {\r\n    return this._wrapNode.removeChild(this._targetNode);\r\n};\r\n\r\nScrollBar.prototype.removeMouseListener = function(){\r\n    Mouse.get().removeEventListener(DocumentEvent.MOUSE_WHEEL,this,'_onMouseWheel');\r\n};\r\n\r\nScrollBar.prototype.addMouseListener = function(){\r\n    Mouse.get().addEventListener(DocumentEvent.MOUSE_WHEEL,this,'_onMouseWheel');\r\n};\r\n\r\nScrollBar.prototype.removeFromParent = function () {\r\n    var parentNode = this._parentNode,\r\n        rootNode = this._node,\r\n        targetNode = this._targetNode;\r\n\r\n    rootNode.removeChild(targetNode);\r\n    parentNode.removeChild(this._wrapNode);\r\n    parentNode.removeChild(rootNode);\r\n\r\n    return targetNode;\r\n};\r\n\r\nScrollBar.prototype.getWrapNode = function () {\r\n    return this._wrapNode;\r\n};\r\n\r\nScrollBar.prototype.getNode = function () {\r\n    return this._node;\r\n};\r\n\r\nScrollBar.prototype.getTargetNode = function () {\r\n    return this._targetNode;\r\n};\r\n\r\n\r\nmodule.exports = ScrollBar;"]},"metadata":{},"sourceType":"script"}