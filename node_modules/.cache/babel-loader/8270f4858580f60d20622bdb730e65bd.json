{"ast":null,"code":"import _classCallCheck from\"/Users/roaa/Desktop/demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/roaa/Desktop/demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import*as THREE from'three';import{easeOutQuad,easeInOutQuad,easeOutSine,easeInOutSine}from'../../utils/easing.utils';var TouchTexture=/*#__PURE__*/function(){function TouchTexture(parent){_classCallCheck(this,TouchTexture);this.parent=parent;this.size=64;this.maxAge=120;this.radius=0.15;this.trail=[];this.initTexture();}_createClass(TouchTexture,[{key:\"initTexture\",value:function initTexture(){this.canvas=document.createElement('canvas');this.canvas.width=this.canvas.height=this.size;this.ctx=this.canvas.getContext('2d');this.ctx.fillStyle='black';this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);this.texture=new THREE.Texture(this.canvas);this.canvas.id='touchTexture';this.canvas.style.width=this.canvas.style.height=\"\".concat(this.canvas.width,\"px\");}},{key:\"update\",value:function update(delta){var _this=this;this.clear();// age points\nthis.trail.forEach(function(point,i){point.age++;// remove old\nif(point.age>_this.maxAge){_this.trail.splice(i,1);}});this.trail.forEach(function(point,i){_this.drawTouch(point);});this.texture.needsUpdate=true;}},{key:\"clear\",value:function clear(){this.ctx.fillStyle='black';this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);}},{key:\"addTouch\",value:function addTouch(point){var force=0;var last=this.trail[this.trail.length-1];if(last){var dx=last.x-point.x;var dy=last.y-point.y;var dd=dx*dx+dy*dy;force=Math.min(dd*10000,1);}this.trail.push({x:point.x,y:point.y,age:0,force:force});}},{key:\"drawTouch\",value:function drawTouch(point){var pos={x:point.x*this.size,y:(1-point.y)*this.size};var intensity=1;if(point.age<this.maxAge*0.3){intensity=easeOutSine(point.age/(this.maxAge*0.3),0,1,1);}else{intensity=easeOutSine(1-(point.age-this.maxAge*0.3)/(this.maxAge*0.7),0,1,1);}intensity*=point.force;var radius=this.size*this.radius*intensity;var grd=this.ctx.createRadialGradient(pos.x,pos.y,radius*0.25,pos.x,pos.y,radius);grd.addColorStop(0,\"rgba(255, 255, 255, 0.2)\");grd.addColorStop(1,'rgba(0, 0, 0, 0.0)');this.ctx.beginPath();this.ctx.fillStyle=grd;this.ctx.arc(pos.x,pos.y,radius,0,Math.PI*2);this.ctx.fill();}}]);return TouchTexture;}();export{TouchTexture as default};","map":{"version":3,"sources":["/Users/roaa/Desktop/demo/src/scripts/webgl/particles/TouchTexture.js"],"names":["THREE","easeOutQuad","easeInOutQuad","easeOutSine","easeInOutSine","TouchTexture","parent","size","maxAge","radius","trail","initTexture","canvas","document","createElement","width","height","ctx","getContext","fillStyle","fillRect","texture","Texture","id","style","delta","clear","forEach","point","i","age","splice","drawTouch","needsUpdate","force","last","length","dx","x","dy","y","dd","Math","min","push","pos","intensity","grd","createRadialGradient","addColorStop","beginPath","arc","PI","fill"],"mappings":"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","sourcesContent":["import * as THREE from 'three';\n\nimport { easeOutQuad, easeInOutQuad, easeOutSine, easeInOutSine } from '../../utils/easing.utils';\n\nexport default class TouchTexture {\n\tconstructor(parent) {\n\t\tthis.parent = parent;\n\t\tthis.size = 64;\n\t\tthis.maxAge = 120;\n\t\tthis.radius = 0.15;\n\t\tthis.trail = [];\n\n\t\tthis.initTexture();\n\t}\n\n\tinitTexture() {\n\t\tthis.canvas = document.createElement('canvas');\n\t\tthis.canvas.width = this.canvas.height = this.size;\n\t\tthis.ctx = this.canvas.getContext('2d');\n\t\tthis.ctx.fillStyle = 'black';\n\t\tthis.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\n\t\tthis.texture = new THREE.Texture(this.canvas);\n\n\t\tthis.canvas.id = 'touchTexture';\n\t\tthis.canvas.style.width = this.canvas.style.height = `${this.canvas.width}px`;\n\t}\n\n\tupdate(delta) {\n\t\tthis.clear();\n\n\t\t// age points\n\t\tthis.trail.forEach((point, i) => {\n\t\t\tpoint.age++;\n\t\t\t// remove old\n\t\t\tif (point.age > this.maxAge) {\n\t\t\t\tthis.trail.splice(i, 1);\n\t\t\t}\n\t\t});\n\n\t\tthis.trail.forEach((point, i) => {\n\t\t\tthis.drawTouch(point);\n\t\t});\n\n\t\tthis.texture.needsUpdate = true;\n\t}\n\n\tclear() {\n\t\tthis.ctx.fillStyle = 'black';\n\t\tthis.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\t}\n\n\taddTouch(point) {\n\t\tlet force = 0;\n\t\tconst last = this.trail[this.trail.length - 1];\n\t\tif (last) {\n\t\t\tconst dx = last.x - point.x;\n\t\t\tconst dy = last.y - point.y;\n\t\t\tconst dd = dx * dx + dy * dy;\n\t\t\tforce = Math.min(dd * 10000, 1);\n\t\t}\n\t\tthis.trail.push({ x: point.x, y: point.y, age: 0, force });\n\t}\n\n\tdrawTouch(point) {\n\t\tconst pos = {\n\t\t\tx: point.x * this.size,\n\t\t\ty: (1 - point.y) * this.size\n\t\t};\n\n\t\tlet intensity = 1;\n\t\tif (point.age < this.maxAge * 0.3) {\n\t\t\tintensity = easeOutSine(point.age / (this.maxAge * 0.3), 0, 1, 1);\n\t\t} else {\n\t\t\tintensity = easeOutSine(1 - (point.age - this.maxAge * 0.3) / (this.maxAge * 0.7), 0, 1, 1);\n\t\t}\n\n\t\tintensity *= point.force;\n\n\t\tconst radius = this.size * this.radius * intensity;\n\t\tconst grd = this.ctx.createRadialGradient(pos.x, pos.y, radius * 0.25, pos.x, pos.y, radius);\n\t\tgrd.addColorStop(0, `rgba(255, 255, 255, 0.2)`);\n\t\tgrd.addColorStop(1, 'rgba(0, 0, 0, 0.0)');\n\n\t\tthis.ctx.beginPath();\n\t\tthis.ctx.fillStyle = grd;\n\t\tthis.ctx.arc(pos.x, pos.y, radius, 0, Math.PI * 2);\n\t\tthis.ctx.fill();\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}