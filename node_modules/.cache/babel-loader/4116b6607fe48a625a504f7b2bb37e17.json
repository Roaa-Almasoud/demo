{"ast":null,"code":"var ObjectComponent = require('../core/ObjectComponent');\n\nvar NumberInput_Internal = require('./NumberInput_Internal');\n\nvar Node = require('../core/document/Node');\n\nvar Options = require('./Options');\n\nvar ButtonPreset = require('./ButtonPreset');\n\nvar CSS = require('../core/document/CSS'),\n    Metric = require('./Metric');\n\nvar Event_ = require('../core/event/Event'),\n    DocumentEvent = require('../core/document/DocumentEvent'),\n    NodeEvent = require('../core/document/NodeEvent'),\n    ComponentEvent = require('../core/ComponentEvent');\n\nvar DEFAULT_INPUT_DP = 2,\n    DEFAULT_INPUT_STEP = 1,\n    DEFAULT_INPUT_PRESET = null;\n\nfunction NumberInput(parent, object, value, params) {\n  ObjectComponent.apply(this, arguments);\n  params = params || {};\n  params.onBegin = params.onBegin || null;\n  params.onChange = params.onChange || this._onChange;\n  params.onFinish = params.onFinish || null;\n  params.onError = params.onError || null;\n  params.dp = params.dp === undefined || params.dp == null ? DEFAULT_INPUT_DP : params.dp;\n  params.step = params.step || DEFAULT_INPUT_STEP;\n  params.presets = params.presets || DEFAULT_INPUT_PRESET;\n  this._onBegin = params.onBegin;\n  this._onChange = params.onChange;\n  this._presetsKey = params.presets;\n  var input = this._input = new NumberInput_Internal(params.step, params.dp, params.onBegin, this._onInputChange.bind(this), params.onFinish, params.onError);\n  var wrap = this._wrapNode;\n  var presets = params.presets;\n\n  if (!presets) {\n    wrap.addChild(input.getNode());\n  } else {\n    var wrap_ = new Node();\n    wrap_.setStyleClass(CSS.WrapInputWPreset);\n    wrap.addChild(wrap_);\n    wrap_.addChild(input.getNode());\n    var options = Options.get();\n    var presetBtn = this._btnPreset = new ButtonPreset(this._wrapNode);\n\n    var onPresetDeactivate = function onPresetDeactivate() {\n      options.clear();\n      presetBtn.deactivate();\n    };\n\n    var self = this;\n\n    var onPresetActivate = function onPresetActivate() {\n      options.build(presets, input.getValue(), input.getNode(), function () {\n        input.setValue(presets[options.getSelectedIndex()]);\n        self.applyValue();\n\n        self._onChange(self._obj[self._key]);\n      }, onPresetDeactivate, Metric.PADDING_PRESET, false);\n    };\n\n    presetBtn.setOnActive(onPresetActivate);\n    presetBtn.setOnDeactive(onPresetDeactivate);\n  }\n\n  input.getNode().addEventListener(NodeEvent.MOUSE_DOWN, this._onInputDragStart.bind(this));\n  this.addEventListener(ComponentEvent.INPUT_SELECT_DRAG, this._parent, 'onComponentSelectDrag');\n  input.setValue(this._obj[this._key]);\n}\n\nNumberInput.prototype = Object.create(ObjectComponent.prototype);\nNumberInput.prototype.constructor = NumberInput;\n\nNumberInput.prototype._onInputChange = function () {\n  this.applyValue();\n\n  this._onChange(this._obj[this._key]);\n};\n\nNumberInput.prototype.applyValue = function () {\n  this.pushHistoryState();\n  this._obj[this._key] = this._input.getValue();\n  this.dispatchEvent(new Event_(this, ComponentEvent.VALUE_UPDATED, null));\n};\n\nNumberInput.prototype.onValueUpdate = function (e) {\n  if (e.data.origin == this) {\n    return;\n  }\n\n  this._input.setValue(this._obj[this._key]);\n}; //Prevent chrome select drag\n\n\nNumberInput.prototype._onInputDragStart = function () {\n  var eventMove = DocumentEvent.MOUSE_MOVE,\n      eventUp = DocumentEvent.MOUSE_UP;\n  var event = ComponentEvent.INPUT_SELECT_DRAG;\n  var self = this;\n\n  var onDrag = function onDrag() {\n    self.dispatchEvent(new Event_(this, event, null));\n  },\n      onDragFinish = function onDragFinish() {\n    self.dispatchEvent(new Event_(this, event, null));\n    document.removeEventListener(eventMove, onDrag, false);\n    document.removeEventListener(eventMove, onDragFinish, false);\n  };\n\n  this.dispatchEvent(new Event_(this, event, null));\n  document.addEventListener(eventMove, onDrag, false);\n  document.addEventListener(eventUp, onDragFinish, false);\n};\n\nmodule.exports = NumberInput;","map":{"version":3,"sources":["/Users/roaa/Desktop/demo/node_modules/@brunoimbrizi/controlkit/lib/component/NumberInput.js"],"names":["ObjectComponent","require","NumberInput_Internal","Node","Options","ButtonPreset","CSS","Metric","Event_","DocumentEvent","NodeEvent","ComponentEvent","DEFAULT_INPUT_DP","DEFAULT_INPUT_STEP","DEFAULT_INPUT_PRESET","NumberInput","parent","object","value","params","apply","arguments","onBegin","onChange","_onChange","onFinish","onError","dp","undefined","step","presets","_onBegin","_presetsKey","input","_input","_onInputChange","bind","wrap","_wrapNode","addChild","getNode","wrap_","setStyleClass","WrapInputWPreset","options","get","presetBtn","_btnPreset","onPresetDeactivate","clear","deactivate","self","onPresetActivate","build","getValue","setValue","getSelectedIndex","applyValue","_obj","_key","PADDING_PRESET","setOnActive","setOnDeactive","addEventListener","MOUSE_DOWN","_onInputDragStart","INPUT_SELECT_DRAG","_parent","prototype","Object","create","constructor","pushHistoryState","dispatchEvent","VALUE_UPDATED","onValueUpdate","e","data","origin","eventMove","MOUSE_MOVE","eventUp","MOUSE_UP","event","onDrag","onDragFinish","document","removeEventListener","module","exports"],"mappings":"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","sourcesContent":["var ObjectComponent = require('../core/ObjectComponent');\r\nvar NumberInput_Internal = require('./NumberInput_Internal');\r\n\r\nvar Node = require('../core/document/Node');\r\n\r\nvar Options = require('./Options');\r\nvar ButtonPreset = require('./ButtonPreset');\r\nvar CSS = require('../core/document/CSS'),\r\n    Metric = require('./Metric');\r\n\r\nvar Event_ = require('../core/event/Event'),\r\n    DocumentEvent = require('../core/document/DocumentEvent'),\r\n    NodeEvent = require('../core/document/NodeEvent'),\r\n    ComponentEvent = require('../core/ComponentEvent');\r\n\r\nvar DEFAULT_INPUT_DP     = 2,\r\n    DEFAULT_INPUT_STEP   = 1,\r\n    DEFAULT_INPUT_PRESET = null;\r\n\r\n\r\n\r\nfunction NumberInput(parent,object,value,params) {\r\n    ObjectComponent.apply(this,arguments);\r\n\r\n    params          = params || {};\r\n    params.onBegin  = params.onBegin || null;\r\n    params.onChange = params.onChange || this._onChange;\r\n    params.onFinish = params.onFinish || null;\r\n    params.onError  = params.onError || null;\r\n    params.dp       = (params.dp === undefined || params.dp == null) ? DEFAULT_INPUT_DP : params.dp;\r\n    params.step     = params.step     || DEFAULT_INPUT_STEP;\r\n    params.presets  = params.presets  || DEFAULT_INPUT_PRESET;\r\n\r\n    this._onBegin     = params.onBegin;\r\n    this._onChange    = params.onChange;\r\n    this._presetsKey  = params.presets;\r\n\r\n    var input = this._input = new NumberInput_Internal(params.step,\r\n                                                       params.dp,\r\n                                                       params.onBegin,\r\n                                                       this._onInputChange.bind(this),\r\n                                                       params.onFinish,\r\n                                                       params.onError);\r\n\r\n    var wrap = this._wrapNode;\r\n\r\n    var presets =  params.presets;\r\n    if (!presets) {\r\n        wrap.addChild(input.getNode());\r\n    }\r\n    else {\r\n        var wrap_ = new Node();\r\n            wrap_.setStyleClass(CSS.WrapInputWPreset);\r\n\r\n        wrap.addChild(wrap_);\r\n        wrap_.addChild(input.getNode());\r\n\r\n        var options   = Options.get();\r\n        var presetBtn = this._btnPreset = new ButtonPreset(this._wrapNode);\r\n\r\n        var onPresetDeactivate = function(){\r\n            options.clear();\r\n            presetBtn.deactivate();\r\n        };\r\n\r\n        var self = this;\r\n        var onPresetActivate = function () {\r\n            options.build(presets, input.getValue(), input.getNode(),\r\n                function () {\r\n                    input.setValue(presets[options.getSelectedIndex()]);\r\n                    self.applyValue();\r\n                    self._onChange(self._obj[self._key]);\r\n                },\r\n                onPresetDeactivate, Metric.PADDING_PRESET,\r\n                false);\r\n        };\r\n        presetBtn.setOnActive(onPresetActivate);\r\n        presetBtn.setOnDeactive(onPresetDeactivate)\r\n    }\r\n\r\n    input.getNode().addEventListener(NodeEvent.MOUSE_DOWN,   this._onInputDragStart.bind(this));\r\n    this.addEventListener(ComponentEvent.INPUT_SELECT_DRAG,this._parent,'onComponentSelectDrag');\r\n\r\n    input.setValue(this._obj[this._key]);\r\n}\r\nNumberInput.prototype = Object.create(ObjectComponent.prototype);\r\nNumberInput.prototype.constructor = NumberInput;\r\n\r\nNumberInput.prototype._onInputChange = function () {\r\n    this.applyValue();\r\n    this._onChange(this._obj[this._key]);\r\n};\r\n\r\nNumberInput.prototype.applyValue = function() {\r\n    this.pushHistoryState();\r\n    this._obj[this._key] = this._input.getValue();\r\n    this.dispatchEvent(new Event_(this,ComponentEvent.VALUE_UPDATED,null));\r\n};\r\n\r\nNumberInput.prototype.onValueUpdate = function (e) {\r\n    if (e.data.origin == this){\r\n        return;\r\n    }\r\n    this._input.setValue(this._obj[this._key]);\r\n};\r\n\r\n//Prevent chrome select drag\r\nNumberInput.prototype._onInputDragStart = function () {\r\n    var eventMove = DocumentEvent.MOUSE_MOVE,\r\n        eventUp = DocumentEvent.MOUSE_UP;\r\n\r\n    var event = ComponentEvent.INPUT_SELECT_DRAG;\r\n\r\n    var self = this;\r\n\r\n    var onDrag = function () {\r\n            self.dispatchEvent(new Event_(this, event, null));\r\n        },\r\n        onDragFinish = function () {\r\n            self.dispatchEvent(new Event_(this, event, null));\r\n            document.removeEventListener(eventMove, onDrag, false);\r\n            document.removeEventListener(eventMove, onDragFinish, false);\r\n        };\r\n\r\n    this.dispatchEvent(new Event_(this, event, null));\r\n\r\n    document.addEventListener(eventMove, onDrag, false);\r\n    document.addEventListener(eventUp, onDragFinish, false);\r\n};\r\n\r\nmodule.exports = NumberInput;"]},"metadata":{},"sourceType":"script"}