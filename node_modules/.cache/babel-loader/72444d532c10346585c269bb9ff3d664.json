{"ast":null,"code":"var Plotter = require('./Plotter');\n\nvar Mouse = require('../core/document/Mouse');\n\nvar Event_ = require('../core/event/Event'),\n    DocumentEvent = require('../core/document/DocumentEvent'),\n    ComponentEvent = require('../core/ComponentEvent');\n\nvar DEFAULT_BOUNDS_X = [-1, 1],\n    DEFAULT_BOUNDS_Y = [-1, 1],\n    DEFAULT_LABEL_X = '',\n    DEFAULT_LABEL_Y = '';\n\nfunction Pad(parent, object, value, params) {\n  Plotter.apply(this, arguments);\n  params = params || {};\n  params.boundsX = params.boundsX || DEFAULT_BOUNDS_X;\n  params.boundsY = params.boundsY || DEFAULT_BOUNDS_Y;\n  params.labelX = params.labelX || DEFAULT_LABEL_X;\n  params.labelY = params.labelY || DEFAULT_LABEL_Y;\n  params.showCross = params.showCross || true;\n  this._onChange = params.onChange || this._onChange;\n\n  this._onFinish = params.onFinish || function () {};\n\n  this._boundsX = params.boundsX;\n  this._boundsY = params.boundsY;\n  this._labelAxisX = params.labelX != '' && params.labelX != 'none' ? params.labelX : null;\n  this._labelAxisY = params.labelY != '' && params.labelY != 'none' ? params.labelY : null;\n  var path = this._path;\n  path.style.strokeWidth = 1;\n  path.style.stroke = '#363c40';\n  this._grid.style.stroke = 'rgb(25,25,25)';\n  this._svgPos = [0, 0];\n\n  var handle = this._handle = this._svgRoot.appendChild(this._createSVGObject('g'));\n\n  var handleCircle0 = handle.appendChild(this._createSVGObject('circle'));\n  handleCircle0.setAttribute('r', String(11));\n  handleCircle0.setAttribute('fill', 'rgba(0,0,0,0.05)');\n  var handleCircle1 = handle.appendChild(this._createSVGObject('circle'));\n  handleCircle1.setAttribute('r', String(10));\n  handleCircle1.setAttribute('fill', 'rgb(83,93,98)');\n  var handleCircle2 = handle.appendChild(this._createSVGObject('circle'));\n  handleCircle2.setAttribute('r', String(9));\n  handleCircle2.setAttribute('fill', 'rgb(57,69,76)');\n  handleCircle2.setAttribute('cy', String(0.75));\n  var handleCircle3 = handle.appendChild(this._createSVGObject('circle'));\n  handleCircle3.setAttribute('r', String(10));\n  handleCircle3.setAttribute('stroke', 'rgb(17,19,20)');\n  handleCircle3.setAttribute('stroke-width', String(1));\n  handleCircle3.setAttribute('fill', 'none');\n  var handleCircle4 = handle.appendChild(this._createSVGObject('circle'));\n  handleCircle4.setAttribute('r', String(6));\n  handleCircle4.setAttribute('fill', 'rgb(30,34,36)');\n  var handleCircle5 = handle.appendChild(this._createSVGObject('circle'));\n  handleCircle5.setAttribute('r', String(3));\n  handleCircle5.setAttribute('fill', 'rgb(255,255,255)');\n  handle.setAttribute('tranform', 'translate(0 0)');\n\n  this._svg.addEventListener(DocumentEvent.MOUSE_DOWN, this._onDragStart.bind(this), false);\n\n  this._drawValue(this._obj[this._key]);\n}\n\nPad.prototype = Object.create(Plotter.prototype);\nPad.prototype.constructor = Pad;\n\nPad.prototype._onDragStart = function () {\n  var svgPos = this._svgPos;\n  svgPos[0] = 0;\n  svgPos[1] = 0; //skip to container\n\n  var element = this._svg.parentNode;\n\n  while (element) {\n    svgPos[0] += element.offsetLeft;\n    svgPos[1] += element.offsetTop;\n    element = element.offsetParent;\n  }\n\n  var eventMove = DocumentEvent.MOUSE_MOVE,\n      eventUp = DocumentEvent.MOUSE_UP;\n\n  var onDrag = function () {\n    this._drawValueInput();\n\n    this.applyValue();\n\n    this._onChange();\n  }.bind(this);\n\n  var onDragEnd = function () {\n    this.pushHistoryState();\n\n    this._drawValueInput();\n\n    this.applyValue();\n\n    this._onFinish();\n\n    document.removeEventListener(eventMove, onDrag, false);\n    document.removeEventListener(eventUp, onDragEnd, false);\n  }.bind(this);\n\n  document.addEventListener(eventMove, onDrag, false);\n  document.addEventListener(eventUp, onDragEnd, false);\n\n  this._drawValueInput();\n\n  this.applyValue();\n\n  this._onChange();\n};\n\nPad.prototype._redraw = function () {\n  this._drawValue(this._obj[this._key]);\n};\n\nPad.prototype._drawValueInput = function () {\n  this._drawValue(this._getMouseNormalized());\n};\n\nPad.prototype._drawValue = function (value) {\n  this._obj[this._key] = value;\n\n  this._drawGrid();\n\n  this._drawPoint();\n};\n\nPad.prototype._drawGrid = function () {\n  var svgSize = Number(this._svg.getAttribute('width')),\n      svgMidX = Math.floor(svgSize * 0.5),\n      svgMidY = Math.floor(svgSize * 0.5);\n  var pathCmd = '';\n  pathCmd += this._pathCmdLine(0, svgMidY, svgSize, svgMidY);\n  pathCmd += this._pathCmdLine(svgMidX, 0, svgMidX, svgSize);\n\n  this._grid.setAttribute('d', pathCmd);\n};\n\nPad.prototype._drawPoint = function () {\n  var svgSize = Number(this._svg.getAttribute('width'));\n  var value = this._obj[this._key];\n  var localX = (0.5 + value[0] * 0.5) * svgSize,\n      localY = (0.5 + -value[1] * 0.5) * svgSize;\n  var pathCmd = '';\n  pathCmd += this._pathCmdLine(0, localY, svgSize, localY);\n  pathCmd += this._pathCmdLine(localX, 0, localX, svgSize);\n\n  this._path.setAttribute('d', pathCmd);\n\n  this._handle.setAttribute('transform', 'translate(' + localX + ' ' + localY + ')');\n};\n\nPad.prototype._getMouseNormalized = function () {\n  var offset = this._svgPos,\n      mouse = Mouse.get().getPosition(),\n      svgSize = Number(this._svg.getAttribute('width'));\n  return [-1 + Math.max(0, Math.min(mouse[0] - offset[0], svgSize)) / svgSize * 2, 1 - Math.max(0, Math.min(mouse[1] - offset[1], svgSize)) / svgSize * 2];\n};\n\nPad.prototype.applyValue = function () {\n  this.dispatchEvent(new Event_(this, ComponentEvent.VALUE_UPDATED, null));\n};\n\nPad.prototype.onValueUpdate = function (e) {\n  if (e.data.origin == this) return;\n\n  this._drawValue(this._obj[this._key]);\n};\n\nmodule.exports = Pad;","map":{"version":3,"sources":["/Users/roaa/Desktop/demo/node_modules/@brunoimbrizi/controlkit/lib/component/Pad.js"],"names":["Plotter","require","Mouse","Event_","DocumentEvent","ComponentEvent","DEFAULT_BOUNDS_X","DEFAULT_BOUNDS_Y","DEFAULT_LABEL_X","DEFAULT_LABEL_Y","Pad","parent","object","value","params","apply","arguments","boundsX","boundsY","labelX","labelY","showCross","_onChange","onChange","_onFinish","onFinish","_boundsX","_boundsY","_labelAxisX","_labelAxisY","path","_path","style","strokeWidth","stroke","_grid","_svgPos","handle","_handle","_svgRoot","appendChild","_createSVGObject","handleCircle0","setAttribute","String","handleCircle1","handleCircle2","handleCircle3","handleCircle4","handleCircle5","_svg","addEventListener","MOUSE_DOWN","_onDragStart","bind","_drawValue","_obj","_key","prototype","Object","create","constructor","svgPos","element","parentNode","offsetLeft","offsetTop","offsetParent","eventMove","MOUSE_MOVE","eventUp","MOUSE_UP","onDrag","_drawValueInput","applyValue","onDragEnd","pushHistoryState","document","removeEventListener","_redraw","_getMouseNormalized","_drawGrid","_drawPoint","svgSize","Number","getAttribute","svgMidX","Math","floor","svgMidY","pathCmd","_pathCmdLine","localX","localY","offset","mouse","get","getPosition","max","min","dispatchEvent","VALUE_UPDATED","onValueUpdate","e","data","origin","module","exports"],"mappings":"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","sourcesContent":["var Plotter = require('./Plotter');\r\nvar Mouse = require('../core/document/Mouse');\r\n\r\nvar Event_         = require('../core/event/Event'),\r\n    DocumentEvent  = require('../core/document/DocumentEvent'),\r\n    ComponentEvent = require('../core/ComponentEvent');\r\n\r\nvar DEFAULT_BOUNDS_X = [-1,1],\r\n    DEFAULT_BOUNDS_Y = [-1,1],\r\n    DEFAULT_LABEL_X  = '',\r\n    DEFAULT_LABEL_Y  = '';\r\n\r\nfunction Pad(parent, object, value, params) {\r\n    Plotter.apply(this,arguments);\r\n\r\n    params            = params            || {};\r\n    params.boundsX    = params.boundsX    || DEFAULT_BOUNDS_X;\r\n    params.boundsY    = params.boundsY    || DEFAULT_BOUNDS_Y;\r\n    params.labelX     = params.labelX     || DEFAULT_LABEL_X;\r\n    params.labelY     = params.labelY     || DEFAULT_LABEL_Y;\r\n\r\n    params.showCross  = params.showCross  || true;\r\n\r\n\r\n    this._onChange     = params.onChange || this._onChange;\r\n    this._onFinish     = params.onFinish || function(){};\r\n\r\n    this._boundsX      = params.boundsX;\r\n    this._boundsY      = params.boundsY;\r\n    this._labelAxisX   = params.labelX != '' && params.labelX != 'none' ? params.labelX : null;\r\n    this._labelAxisY   = params.labelY != '' && params.labelY != 'none' ? params.labelY : null;\r\n\r\n    var path = this._path;\r\n        path.style.strokeWidth = 1;\r\n        path.style.stroke      = '#363c40';\r\n\r\n    this._grid.style.stroke = 'rgb(25,25,25)';\r\n\r\n    this._svgPos = [0,0];\r\n\r\n\r\n    var handle = this._handle = this._svgRoot.appendChild(this._createSVGObject('g'));\r\n    var handleCircle0 = handle.appendChild(this._createSVGObject('circle'));\r\n        handleCircle0.setAttribute('r',String(11));\r\n        handleCircle0.setAttribute('fill','rgba(0,0,0,0.05)');\r\n    var handleCircle1 = handle.appendChild(this._createSVGObject('circle'));\r\n        handleCircle1.setAttribute('r',String(10));\r\n        handleCircle1.setAttribute('fill','rgb(83,93,98)');\r\n\r\n    var handleCircle2 = handle.appendChild(this._createSVGObject('circle'));\r\n        handleCircle2.setAttribute('r',String(9));\r\n        handleCircle2.setAttribute('fill','rgb(57,69,76)');\r\n        handleCircle2.setAttribute('cy',String(0.75));\r\n\r\n    var handleCircle3 = handle.appendChild(this._createSVGObject('circle'));\r\n        handleCircle3.setAttribute('r',String(10));\r\n        handleCircle3.setAttribute('stroke','rgb(17,19,20)');\r\n        handleCircle3.setAttribute('stroke-width',String(1));\r\n        handleCircle3.setAttribute('fill','none');\r\n\r\n    var handleCircle4 = handle.appendChild(this._createSVGObject('circle'));\r\n        handleCircle4.setAttribute('r',String(6));\r\n        handleCircle4.setAttribute('fill','rgb(30,34,36)');\r\n    var handleCircle5 = handle.appendChild(this._createSVGObject('circle'));\r\n        handleCircle5.setAttribute('r',String(3));\r\n        handleCircle5.setAttribute('fill','rgb(255,255,255)');\r\n\r\n        handle.setAttribute('tranform','translate(0 0)');\r\n\r\n    this._svg.addEventListener(DocumentEvent.MOUSE_DOWN,this._onDragStart.bind(this),false);\r\n    this._drawValue(this._obj[this._key]);\r\n}\r\nPad.prototype = Object.create(Plotter.prototype);\r\nPad.prototype.constructor = Pad;\r\n\r\nPad.prototype._onDragStart = function () {\r\n    var svgPos = this._svgPos;\r\n    svgPos[0] = 0;\r\n    svgPos[1] = 0;\r\n\r\n    //skip to container\r\n    var element = this._svg.parentNode;\r\n\r\n    while (element) {\r\n        svgPos[0] += element.offsetLeft;\r\n        svgPos[1] += element.offsetTop;\r\n        element = element.offsetParent;\r\n    }\r\n\r\n    var eventMove = DocumentEvent.MOUSE_MOVE,\r\n        eventUp   = DocumentEvent.MOUSE_UP;\r\n\r\n    var onDrag = function () {\r\n        this._drawValueInput();\r\n        this.applyValue();\r\n        this._onChange();\r\n    }.bind(this);\r\n\r\n    var onDragEnd = function () {\r\n        this.pushHistoryState();\r\n        this._drawValueInput();\r\n        this.applyValue();\r\n        this._onFinish();\r\n\r\n        document.removeEventListener(eventMove, onDrag, false);\r\n        document.removeEventListener(eventUp, onDragEnd, false);\r\n    }.bind(this);\r\n\r\n    document.addEventListener(eventMove, onDrag,    false);\r\n    document.addEventListener(eventUp,   onDragEnd, false);\r\n\r\n    this._drawValueInput();\r\n    this.applyValue();\r\n    this._onChange();\r\n};\r\n\r\nPad.prototype._redraw = function () {\r\n    this._drawValue(this._obj[this._key]);\r\n};\r\n\r\nPad.prototype._drawValueInput = function () {\r\n    this._drawValue(this._getMouseNormalized());\r\n};\r\n\r\nPad.prototype._drawValue = function (value) {\r\n    this._obj[this._key] = value;\r\n    this._drawGrid();\r\n    this._drawPoint();\r\n};\r\n\r\nPad.prototype._drawGrid = function () {\r\n    var svgSize = Number(this._svg.getAttribute('width')),\r\n        svgMidX = Math.floor(svgSize * 0.5),\r\n        svgMidY = Math.floor(svgSize * 0.5);\r\n\r\n    var pathCmd = '';\r\n    pathCmd += this._pathCmdLine(0, svgMidY, svgSize, svgMidY);\r\n    pathCmd += this._pathCmdLine(svgMidX, 0, svgMidX, svgSize);\r\n\r\n    this._grid.setAttribute('d', pathCmd);\r\n};\r\n\r\n\r\nPad.prototype._drawPoint = function () {\r\n    var svgSize = Number(this._svg.getAttribute('width'));\r\n\r\n    var value = this._obj[this._key];\r\n\r\n    var localX = ( 0.5 + value[0] * 0.5 ) * svgSize,\r\n        localY = ( 0.5 + -value[1] * 0.5 ) * svgSize;\r\n\r\n    var pathCmd = '';\r\n        pathCmd += this._pathCmdLine(0, localY, svgSize, localY);\r\n        pathCmd += this._pathCmdLine(localX, 0, localX, svgSize);\r\n\r\n    this._path.setAttribute('d', pathCmd);\r\n    this._handle.setAttribute('transform', 'translate(' + localX + ' ' + localY + ')');\r\n};\r\n\r\nPad.prototype._getMouseNormalized = function () {\r\n    var offset = this._svgPos,\r\n        mouse = Mouse.get().getPosition(),\r\n        svgSize = Number(this._svg.getAttribute('width'));\r\n\r\n    return [-1 + Math.max(0, Math.min(mouse[0] - offset[0], svgSize)) / svgSize * 2,\r\n            ( 1 - Math.max(0, Math.min(mouse[1] - offset[1], svgSize)) / svgSize * 2)];\r\n\r\n};\r\n\r\nPad.prototype.applyValue = function () {\r\n    this.dispatchEvent(new Event_(this, ComponentEvent.VALUE_UPDATED, null));\r\n};\r\n\r\nPad.prototype.onValueUpdate = function (e) {\r\n    if (e.data.origin == this)return;\r\n    this._drawValue(this._obj[this._key]);\r\n};\r\n\r\nmodule.exports = Pad;\r\n"]},"metadata":{},"sourceType":"script"}