{"ast":null,"code":"var AbstractGroup = require('./AbstractGroup');\n\nvar CSS = require('../core/document/CSS');\n\nvar Node = require('../core/document/Node');\n\nvar SubGroup = require('./SubGroup');\n\nvar Event_ = require('../core/event/Event'),\n    DocumentEvent = require('../core/document/DocumentEvent'),\n    NodeEvent = require('../core/document/NodeEvent'),\n    PanelEvent = require('./PanelEvent'),\n    GroupEvent = require('./GroupEvent');\n\nvar ObjectComponent = require('../core/ObjectComponent'),\n    ValuePlotter = require('../component/ValuePlotter'),\n    FunctionPlotter = require('../component/FunctionPlotter');\n\nfunction Group(parent, params) {\n  params = params || {};\n  params.label = params.label || null;\n  params.useLabels = params.useLabels || true;\n  params.enable = params.enable === undefined ? true : params.enable;\n  AbstractGroup.apply(this, arguments);\n  this._components = [];\n  this._subGroups = [];\n  var root = this._node,\n      wrap = this._wrapNode,\n      list = this._listNode;\n  root.setStyleClass(CSS.Group);\n  wrap.setStyleClass(CSS.Wrap);\n  list.setStyleClass(CSS.SubGroupList);\n  wrap.addChild(list);\n  var label = params.label;\n\n  if (label) {\n    var head = new Node(),\n        wrap_ = new Node(),\n        label_ = new Node(Node.SPAN),\n        indicator = this._indiNode = new Node();\n    head.setStyleClass(CSS.Head);\n    wrap_.setStyleClass(CSS.Wrap);\n    label_.setStyleClass(CSS.Label);\n    indicator.setStyleClass(CSS.ArrowBMax);\n    label_.setProperty('innerHTML', label);\n    head.addChild(indicator);\n    wrap_.addChild(label_);\n    head.addChild(wrap_);\n    root.addChild(head);\n    head.addEventListener(NodeEvent.MOUSE_DOWN, this._onHeadTrigger.bind(this));\n    this.addEventListener(GroupEvent.GROUP_LIST_SIZE_CHANGE, parent, 'onGroupListSizeChange');\n\n    this._updateAppearance();\n  }\n\n  if (this.hasMaxHeight()) {\n    this.addScrollWrap();\n  }\n\n  root.addChild(wrap);\n\n  if (this.hasMaxHeight()) {\n    if (!label) {\n      var bufferTop = this._scrollBufferTop = new Node();\n      bufferTop.setStyleClass(CSS.ScrollBuffer);\n      root.addChildAt(bufferTop, 0);\n    }\n\n    var bufferBottom = this._scrollBufferBottom = new Node();\n    bufferBottom.setStyleClass(CSS.ScrollBuffer);\n    root.addChild(bufferBottom);\n  }\n\n  parent = this._parent;\n  parent.addEventListener(PanelEvent.PANEL_MOVE_BEGIN, this, 'onPanelMoveBegin');\n  parent.addEventListener(PanelEvent.PANEL_MOVE, this, 'onPanelMove');\n  parent.addEventListener(PanelEvent.PANEL_MOVE_END, this, 'onPanelMoveEnd');\n  parent.addEventListener(PanelEvent.PANEL_HIDE, this, 'onPanelHide');\n  parent.addEventListener(PanelEvent.PANEL_SHOW, this, 'onPanelShow');\n  parent.addEventListener(PanelEvent.PANEL_SCROLL_WRAP_ADDED, this, 'onPanelScrollWrapAdded');\n  parent.addEventListener(PanelEvent.PANEL_SCROLL_WRAP_REMOVED, this, 'onPanelScrollWrapRemoved');\n  parent.addEventListener(PanelEvent.PANEL_SIZE_CHANGE, this, 'onPanelSizeChange');\n  parent.addEventListener(DocumentEvent.WINDOW_RESIZE, this, 'onWindowResize');\n  this.addEventListener(GroupEvent.GROUP_SIZE_CHANGE, parent, 'onGroupListSizeChange');\n}\n\nGroup.prototype = Object.create(AbstractGroup.prototype);\nGroup.prototype.constructor = Group;\n\nGroup.prototype.onPanelMoveBegin = function () {\n  this.dispatchEvent(new Event_(this, PanelEvent.PANEL_MOVE_BEGIN, null));\n};\n\nGroup.prototype.onPanelMove = function () {\n  this.dispatchEvent(new Event_(this, PanelEvent.PANEL_MOVE, null));\n};\n\nGroup.prototype.onPanelMoveEnd = function () {\n  this.dispatchEvent(new Event_(this, PanelEvent.PANEL_MOVE_END, null));\n};\n\nGroup.prototype.onPanelScrollWrapAdded = function () {\n  this.dispatchEvent(new Event_(this, GroupEvent.GROUP_SIZE_CHANGE, null));\n};\n\nGroup.prototype.onPanelScrollWrapRemoved = function () {\n  this.dispatchEvent(new Event_(this, GroupEvent.GROUP_SIZE_CHANGE, null));\n};\n\nGroup.prototype.onPanelHide = function () {\n  this.dispatchEvent(new Event_(this, GroupEvent.SUBGROUP_DISABLE, null));\n};\n\nGroup.prototype.onPanelShow = function () {\n  this.dispatchEvent(new Event_(this, GroupEvent.SUBGROUP_ENABLE, null));\n};\n\nGroup.prototype.onPanelSizeChange = function () {\n  this.dispatchEvent(new Event_(this, GroupEvent.GROUP_SIZE_CHANGE, null));\n};\n\nGroup.prototype.onWindowResize = function (e) {\n  this.dispatchEvent(e);\n};\n\nGroup.prototype.onSubGroupTrigger = function () {\n  this._updateHeight();\n\n  if (!this.hasMaxHeight()) {\n    return;\n  }\n\n  var scrollBar = this._scrollBar,\n      wrap = this._wrapNode;\n  var bufferTop = this._scrollBufferTop,\n      bufferBottom = this._scrollBufferBottom;\n  scrollBar.update();\n\n  if (!scrollBar.isValid()) {\n    scrollBar.disable();\n    wrap.setHeight(wrap.getChildAt(1).getHeight());\n\n    if (bufferTop) {\n      bufferTop.setStyleProperty('display', 'none');\n    }\n\n    if (bufferBottom) {\n      bufferBottom.setStyleProperty('display', 'none');\n    }\n  } else {\n    scrollBar.enable();\n    wrap.setHeight(this.getMaxHeight());\n\n    if (bufferTop) {\n      bufferTop.setStyleProperty('display', 'block');\n    }\n\n    if (bufferBottom) {\n      bufferBottom.setStyleProperty('display', 'block');\n    }\n  }\n\n  this.dispatchEvent(new Event_(this, GroupEvent.GROUP_SIZE_CHANGE, null));\n};\n\nGroup.prototype._onHeadTrigger = function () {\n  this._enabled = !this._enabled;\n\n  this._updateAppearance();\n\n  this.dispatchEvent(new Event_(this, GroupEvent.GROUP_LIST_SIZE_CHANGE, null));\n};\n\nGroup.prototype.addComponent = function () {\n  var Class_ = arguments[0];\n  var args = Array.prototype.slice.call(arguments);\n  args.shift();\n  args.unshift(this._getSubGroup());\n  var instance = Object.create(Class_.prototype);\n  Class_.apply(instance, args);\n\n  this._components.push(instance);\n\n  this._updateHeight();\n};\n\nGroup.prototype._updateHeight = function () {\n  this._getSubGroup().update();\n\n  this.dispatchEvent(new Event_(this, GroupEvent.GROUP_SIZE_CHANGE, null));\n\n  if (this.hasMaxHeight()) {\n    this._scrollBar.update();\n  }\n};\n\nGroup.prototype._updateAppearance = function () {\n  var wrap = this._wrapNode,\n      indicator = this._indiNode;\n  var scrollBar = this._scrollBar;\n  var bufferTop = this._scrollBufferTop,\n      bufferBottom = this._scrollBufferBottom;\n\n  if (this.isDisabled()) {\n    wrap.setHeight(0);\n\n    if (indicator) {\n      indicator.setStyleClass(CSS.ArrowBMin);\n    }\n\n    if (scrollBar) {\n      if (bufferTop) {\n        bufferTop.setStyleProperty('display', 'none');\n      }\n\n      if (bufferBottom) {\n        bufferBottom.setStyleProperty('display', 'none');\n      }\n    }\n\n    return;\n  }\n\n  if (this.hasMaxHeight()) {\n    var maxHeight = this.getMaxHeight(),\n        listHeight = wrap.getChildAt(1).getHeight();\n    wrap.setHeight(listHeight < maxHeight ? listHeight : maxHeight);\n\n    if (scrollBar.isValid()) {\n      if (bufferTop) {\n        bufferTop.setStyleProperty('display', 'block');\n      }\n\n      if (bufferBottom) {\n        bufferBottom.setStyleProperty('display', 'block');\n      }\n    }\n  } else {\n    wrap.deleteStyleProperty('height');\n  }\n\n  if (indicator) {\n    indicator.setStyleClass(CSS.ArrowBMax);\n  }\n};\n\nGroup.prototype.onGroupSizeUpdate = function () {\n  this._updateAppearance();\n\n  if (this.hasMaxHeight()) {\n    this._scrollBar.update();\n  }\n};\n\nGroup.prototype.addSubGroup = function (params) {\n  this._subGroups.push(new SubGroup(this, params));\n\n  this._updateHeight();\n\n  return this;\n};\n\nGroup.prototype._getSubGroup = function () {\n  var subGroups = this._subGroups;\n\n  if (subGroups.length == 0) {\n    subGroups.push(new SubGroup(this));\n  }\n\n  return subGroups[subGroups.length - 1];\n};\n\nGroup.prototype.getComponents = function () {\n  return this._components;\n};\n\nfunction isDataComp(comp) {\n  return comp instanceof ObjectComponent && !(comp instanceof ValuePlotter) && !(comp instanceof FunctionPlotter);\n}\n\nGroup.prototype.setData = function (data) {\n  var comps = this._components,\n      comp,\n      data_;\n  var i = -1,\n      j = 0,\n      l = comps.length;\n\n  while (++i < l) {\n    comp = comps[i];\n\n    if (!isDataComp(comp)) {\n      continue;\n    }\n\n    data_ = data[j++];\n    comp.setValue(data_[Object.keys(data_)[0]]);\n  }\n};\n\nGroup.prototype.getData = function () {\n  var comps = this._components,\n      i = -1,\n      l = comps.length;\n  var values = [];\n  var comp;\n\n  while (++i < l) {\n    comp = comps[i];\n\n    if (!isDataComp(comp)) {\n      continue;\n    }\n\n    values.push(comp.getData());\n  }\n\n  return values;\n};\n\nmodule.exports = Group;","map":{"version":3,"sources":["/Users/roaa/Desktop/demo/node_modules/@brunoimbrizi/controlkit/lib/group/Group.js"],"names":["AbstractGroup","require","CSS","Node","SubGroup","Event_","DocumentEvent","NodeEvent","PanelEvent","GroupEvent","ObjectComponent","ValuePlotter","FunctionPlotter","Group","parent","params","label","useLabels","enable","undefined","apply","arguments","_components","_subGroups","root","_node","wrap","_wrapNode","list","_listNode","setStyleClass","Wrap","SubGroupList","addChild","head","wrap_","label_","SPAN","indicator","_indiNode","Head","Label","ArrowBMax","setProperty","addEventListener","MOUSE_DOWN","_onHeadTrigger","bind","GROUP_LIST_SIZE_CHANGE","_updateAppearance","hasMaxHeight","addScrollWrap","bufferTop","_scrollBufferTop","ScrollBuffer","addChildAt","bufferBottom","_scrollBufferBottom","_parent","PANEL_MOVE_BEGIN","PANEL_MOVE","PANEL_MOVE_END","PANEL_HIDE","PANEL_SHOW","PANEL_SCROLL_WRAP_ADDED","PANEL_SCROLL_WRAP_REMOVED","PANEL_SIZE_CHANGE","WINDOW_RESIZE","GROUP_SIZE_CHANGE","prototype","Object","create","constructor","onPanelMoveBegin","dispatchEvent","onPanelMove","onPanelMoveEnd","onPanelScrollWrapAdded","onPanelScrollWrapRemoved","onPanelHide","SUBGROUP_DISABLE","onPanelShow","SUBGROUP_ENABLE","onPanelSizeChange","onWindowResize","e","onSubGroupTrigger","_updateHeight","scrollBar","_scrollBar","update","isValid","disable","setHeight","getChildAt","getHeight","setStyleProperty","getMaxHeight","_enabled","addComponent","Class_","args","Array","slice","call","shift","unshift","_getSubGroup","instance","push","isDisabled","ArrowBMin","maxHeight","listHeight","deleteStyleProperty","onGroupSizeUpdate","addSubGroup","subGroups","length","getComponents","isDataComp","comp","setData","data","comps","data_","i","j","l","setValue","keys","getData","values","module","exports"],"mappings":"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","sourcesContent":["var AbstractGroup = require('./AbstractGroup');\r\nvar CSS = require('../core/document/CSS');\r\nvar Node = require('../core/document/Node');\r\n\r\nvar SubGroup = require('./SubGroup');\r\n\r\nvar Event_ = require('../core/event/Event'),\r\n    DocumentEvent = require('../core/document/DocumentEvent'),\r\n    NodeEvent = require('../core/document/NodeEvent'),\r\n    PanelEvent = require('./PanelEvent'),\r\n    GroupEvent = require('./GroupEvent');\r\n\r\nvar ObjectComponent = require('../core/ObjectComponent'),\r\n    ValuePlotter    = require('../component/ValuePlotter'),\r\n    FunctionPlotter = require('../component/FunctionPlotter');\r\n\r\nfunction Group(parent,params) {\r\n    params           = params || {};\r\n    params.label     = params.label     || null;\r\n    params.useLabels = params.useLabels || true;\r\n    params.enable    = params.enable     === undefined ? true : params.enable;\r\n\r\n    AbstractGroup.apply(this,arguments);\r\n\r\n    this._components = [];\r\n    this._subGroups  = [];\r\n\r\n    var root = this._node,\r\n        wrap = this._wrapNode,\r\n        list = this._listNode;\r\n\r\n        root.setStyleClass(CSS.Group);\r\n        wrap.setStyleClass(CSS.Wrap);\r\n        list.setStyleClass(CSS.SubGroupList);\r\n\r\n        wrap.addChild(list);\r\n\r\n    var label = params.label;\r\n\r\n    if(label){\r\n        var head  = new Node(),\r\n            wrap_ = new Node(),\r\n            label_  = new Node(Node.SPAN),\r\n            indicator = this._indiNode = new Node();\r\n\r\n            head.setStyleClass(CSS.Head);\r\n            wrap_.setStyleClass(CSS.Wrap);\r\n            label_.setStyleClass(CSS.Label);\r\n            indicator.setStyleClass(CSS.ArrowBMax);\r\n            label_.setProperty('innerHTML',label);\r\n\r\n            head.addChild(indicator);\r\n            wrap_.addChild(label_);\r\n            head.addChild(wrap_);\r\n            root.addChild(head);\r\n\r\n        head.addEventListener(NodeEvent.MOUSE_DOWN,this._onHeadTrigger.bind(this));\r\n        this.addEventListener(GroupEvent.GROUP_LIST_SIZE_CHANGE,parent,'onGroupListSizeChange');\r\n\r\n        this._updateAppearance();\r\n    }\r\n\r\n    if(this.hasMaxHeight()){\r\n        this.addScrollWrap();\r\n    }\r\n\r\n    root.addChild(wrap);\r\n\r\n    if(this.hasMaxHeight()){\r\n        if(!label){\r\n            var bufferTop = this._scrollBufferTop = new Node();\r\n                bufferTop.setStyleClass(CSS.ScrollBuffer);\r\n\r\n            root.addChildAt(bufferTop,0);\r\n        }\r\n        var bufferBottom = this._scrollBufferBottom = new Node();\r\n            bufferBottom.setStyleClass(CSS.ScrollBuffer);\r\n\r\n        root.addChild(bufferBottom);\r\n    }\r\n\r\n    parent = this._parent;\r\n\r\n    parent.addEventListener(PanelEvent.PANEL_MOVE_BEGIN, this, 'onPanelMoveBegin');\r\n    parent.addEventListener(PanelEvent.PANEL_MOVE, this, 'onPanelMove');\r\n    parent.addEventListener(PanelEvent.PANEL_MOVE_END, this, 'onPanelMoveEnd');\r\n    parent.addEventListener(PanelEvent.PANEL_HIDE, this, 'onPanelHide');\r\n    parent.addEventListener(PanelEvent.PANEL_SHOW, this, 'onPanelShow');\r\n    parent.addEventListener(PanelEvent.PANEL_SCROLL_WRAP_ADDED, this, 'onPanelScrollWrapAdded');\r\n    parent.addEventListener(PanelEvent.PANEL_SCROLL_WRAP_REMOVED, this, 'onPanelScrollWrapRemoved');\r\n    parent.addEventListener(PanelEvent.PANEL_SIZE_CHANGE, this, 'onPanelSizeChange');\r\n    parent.addEventListener(DocumentEvent.WINDOW_RESIZE, this, 'onWindowResize');\r\n\r\n    this.addEventListener(GroupEvent.GROUP_SIZE_CHANGE,parent,'onGroupListSizeChange');\r\n}\r\nGroup.prototype = Object.create(AbstractGroup.prototype);\r\nGroup.prototype.constructor = Group;\r\n\r\nGroup.prototype.onPanelMoveBegin = function () {\r\n    this.dispatchEvent(new Event_(this, PanelEvent.PANEL_MOVE_BEGIN, null));\r\n};\r\n\r\nGroup.prototype.onPanelMove = function () {\r\n    this.dispatchEvent(new Event_(this, PanelEvent.PANEL_MOVE, null));\r\n};\r\n\r\nGroup.prototype.onPanelMoveEnd = function () {\r\n    this.dispatchEvent(new Event_(this, PanelEvent.PANEL_MOVE_END, null));\r\n};\r\n\r\nGroup.prototype.onPanelScrollWrapAdded = function () {\r\n    this.dispatchEvent(new Event_(this, GroupEvent.GROUP_SIZE_CHANGE, null));\r\n};\r\n\r\nGroup.prototype.onPanelScrollWrapRemoved = function () {\r\n    this.dispatchEvent(new Event_(this, GroupEvent.GROUP_SIZE_CHANGE, null));\r\n};\r\n\r\nGroup.prototype.onPanelHide = function () {\r\n    this.dispatchEvent(new Event_(this, GroupEvent.SUBGROUP_DISABLE, null));\r\n};\r\n\r\nGroup.prototype.onPanelShow = function () {\r\n    this.dispatchEvent(new Event_(this, GroupEvent.SUBGROUP_ENABLE, null));\r\n};\r\n\r\nGroup.prototype.onPanelSizeChange = function () {\r\n    this.dispatchEvent(new Event_(this, GroupEvent.GROUP_SIZE_CHANGE, null));\r\n};\r\n\r\nGroup.prototype.onWindowResize = function (e) {\r\n    this.dispatchEvent(e);\r\n};\r\n\r\nGroup.prototype.onSubGroupTrigger = function () {\r\n    this._updateHeight();\r\n\r\n    if(!this.hasMaxHeight()){\r\n        return;\r\n    }\r\n    var scrollBar = this._scrollBar,\r\n        wrap  = this._wrapNode;\r\n    var bufferTop    = this._scrollBufferTop,\r\n        bufferBottom = this._scrollBufferBottom;\r\n\r\n    scrollBar.update();\r\n\r\n    if (!scrollBar.isValid()) {\r\n        scrollBar.disable();\r\n        wrap.setHeight(wrap.getChildAt(1).getHeight());\r\n        if (bufferTop){\r\n            bufferTop.setStyleProperty('display', 'none');\r\n        }\r\n        if (bufferBottom){\r\n            bufferBottom.setStyleProperty('display', 'none');\r\n        }\r\n    }\r\n    else {\r\n        scrollBar.enable();\r\n        wrap.setHeight(this.getMaxHeight());\r\n\r\n        if (bufferTop){\r\n            bufferTop.setStyleProperty('display', 'block');\r\n        }\r\n        if (bufferBottom){\r\n            bufferBottom.setStyleProperty('display', 'block');\r\n        }\r\n    }\r\n    this.dispatchEvent(new Event_(this,GroupEvent.GROUP_SIZE_CHANGE,null));\r\n};\r\n\r\nGroup.prototype._onHeadTrigger = function () {\r\n    this._enabled = !this._enabled;\r\n    this._updateAppearance();\r\n    this.dispatchEvent(new Event_(this, GroupEvent.GROUP_LIST_SIZE_CHANGE, null));\r\n};\r\n\r\nGroup.prototype.addComponent = function(){\r\n    var Class_ = arguments[0];\r\n    var args   = Array.prototype.slice.call(arguments);\r\n        args.shift();\r\n        args.unshift(this._getSubGroup());\r\n\r\n    var instance = Object.create(Class_.prototype);\r\n    Class_.apply(instance,args);\r\n\r\n    this._components.push(instance);\r\n    this._updateHeight();\r\n};\r\n\r\nGroup.prototype._updateHeight = function () {\r\n    this._getSubGroup().update();\r\n    this.dispatchEvent(new Event_(this,GroupEvent.GROUP_SIZE_CHANGE,null));\r\n    if(this.hasMaxHeight()){\r\n        this._scrollBar.update();\r\n    }\r\n};\r\n\r\nGroup.prototype._updateAppearance = function () {\r\n    var wrap = this._wrapNode,\r\n        indicator = this._indiNode;\r\n\r\n    var scrollBar = this._scrollBar;\r\n\r\n    var bufferTop    = this._scrollBufferTop,\r\n        bufferBottom = this._scrollBufferBottom;\r\n\r\n    if (this.isDisabled()) {\r\n        wrap.setHeight(0);\r\n        if (indicator){\r\n            indicator.setStyleClass(CSS.ArrowBMin);\r\n        }\r\n\r\n        if (scrollBar) {\r\n            if (bufferTop){\r\n                bufferTop.setStyleProperty('display', 'none');\r\n            }\r\n            if (bufferBottom){\r\n                bufferBottom.setStyleProperty('display', 'none');\r\n            }\r\n        }\r\n        return;\r\n    }\r\n\r\n    if (this.hasMaxHeight()) {\r\n        var maxHeight = this.getMaxHeight(),\r\n            listHeight = wrap.getChildAt(1).getHeight();\r\n\r\n        wrap.setHeight(listHeight < maxHeight ? listHeight : maxHeight);\r\n\r\n        if (scrollBar.isValid()) {\r\n            if (bufferTop){\r\n                bufferTop.setStyleProperty('display', 'block');\r\n            }\r\n            if (bufferBottom){\r\n                bufferBottom.setStyleProperty('display', 'block');\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        wrap.deleteStyleProperty('height');\r\n    }\r\n    if (indicator){\r\n        indicator.setStyleClass(CSS.ArrowBMax);\r\n    }\r\n};\r\n\r\nGroup.prototype.onGroupSizeUpdate = function () {\r\n    this._updateAppearance();\r\n    if (this.hasMaxHeight()){\r\n        this._scrollBar.update();\r\n    }\r\n};\r\n\r\nGroup.prototype.addSubGroup = function (params) {\r\n    this._subGroups.push(new SubGroup(this, params));\r\n    this._updateHeight();\r\n    return this;\r\n};\r\n\r\nGroup.prototype._getSubGroup = function () {\r\n    var subGroups = this._subGroups;\r\n    if (subGroups.length == 0){\r\n        subGroups.push(new SubGroup(this));\r\n    }\r\n    return subGroups[subGroups.length - 1];\r\n};\r\n\r\nGroup.prototype.getComponents = function () {\r\n    return this._components;\r\n};\r\n\r\nfunction isDataComp(comp){\r\n    return  (comp instanceof ObjectComponent) &&\r\n           !(comp instanceof ValuePlotter) &&\r\n           !(comp instanceof FunctionPlotter);\r\n}\r\n\r\n\r\nGroup.prototype.setData = function(data){\r\n    var comps = this._components, comp, data_;\r\n    var i = -1, j = 0, l = comps.length;\r\n    while(++i < l){\r\n        comp = comps[i];\r\n        if(!isDataComp(comp)){\r\n            continue;\r\n        }\r\n        data_ = data[j++];\r\n        comp.setValue(data_[Object.keys(data_)[0]]);\r\n    }\r\n};\r\n\r\nGroup.prototype.getData = function(){\r\n    var comps = this._components,\r\n        i = -1, l = comps.length;\r\n    var values = [];\r\n    var comp;\r\n    while(++i < l){\r\n        comp = comps[i];\r\n        if(!isDataComp(comp)){\r\n            continue;\r\n        }\r\n        values.push(comp.getData());\r\n    }\r\n    return values;\r\n};\r\n\r\nmodule.exports = Group;\r\n"]},"metadata":{},"sourceType":"script"}