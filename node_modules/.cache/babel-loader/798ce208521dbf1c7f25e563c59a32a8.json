{"ast":null,"code":"var DialogTemplate = '<head>\\n' + '   <title>ControlKit State</title>\\n' + '   <style type=\"text/css\">\\n' + '      body{\\n' + '          box-sizing: border-box;\\n' + '          padding: 20px;\\n' + '          margin: 0;\\n' + '          font-family: Arial, sans-serif;\\n' + '          width: 100%;\\n' + '      }\\n' + '      textarea{\\n' + '          margin-bottom:10px;\\n' + '          box-sizing: border-box;\\n' + '          padding: 0;\\n' + '          border: 0;\\n' + '          border: 1px solid #dedede;\\n' + '          outline: none;\\n' + '          font-family: Monaco, monospace;\\n' + '          font-size: 11px;\\n' + '          resize: none;\\n' + '          word-wrap: break-word;\\n' + '          display: block;\\n' + '          width: 100%;\\n' + '          overflow-y: scroll;\\n' + '          height: 125px;\\n' + '      }\\n' + '      button{\\n' + '          margin: 0;\\n' + '          padding: 0 5px 3px 5px;\\n' + '          height: 20px;\\n' + '      }\\n' + '      #save,#filename,#load{\\n' + '          float: right;\\n' + '      }\\n' + '      input[type=\"text\"]{\\n' + '          margin: 0;\\n' + '          padding: 0;\\n' + '          width: 45%;\\n' + '          height:20px;\\n' + '      }\\n' + '   </style>\\n' + '</head>\\n' + '<body>\\n' + '   <textarea name=\"state\" id=\"state\"></textarea>\\n' + '</body>';\nvar SaveDialogTemplate = '<button type=\"button\" id=\"save\">Save</button>\\n' + '<input type=\"text\" id=\"filename\" value=\"ck-state.json\"></input>';\nvar LoadDialogTemplate = '<input type=\"file\" id=\"load-disk\"></button>' + '<button type=\"button\" id=\"load\">Load</button>';\n\nfunction createWindow() {\n  var width = 320,\n      height = 200;\n  var window_ = window.open('', '', '\\\r\n        width=' + width + ',\\\r\n        height=' + height + ',\\\r\n        left=' + (window.screenX + window.innerWidth * 0.5 - width * 0.5) + ',\\\r\n        top=' + (window.screenY + window.innerHeight * 0.5 - height * 0.5) + ',\\\r\n        location=0,\\\r\n        titlebar=0,\\\r\n        resizable=0');\n  window_.document.documentElement.innerHTML = DialogTemplate;\n  return window_;\n}\n\nfunction save(data) {\n  var window_ = createWindow();\n  var document_ = window_.document;\n  document_.body.innerHTML += SaveDialogTemplate;\n  document_.getElementById('save').addEventListener('click', function () {\n    //log & save in main window\n    var str = document_.getElementById('state').value,\n        blob = new Blob([str], {\n      type: 'application:json'\n    }),\n        name = document_.getElementById('filename').value;\n    var a = document.createElement('a');\n    a.download = name;\n\n    if (window.webkitURL) {\n      a.href = window.webkitURL.createObjectURL(blob);\n    } else {\n      a.href = window.createObjectURL(blob);\n      a.style.display = 'none';\n      a.addEventListener('click', function () {\n        document_.body.removeChild(a);\n      });\n      document_.body.appendChild(a);\n    }\n\n    a.click();\n  });\n  document_.getElementById('state').innerText = JSON.stringify(data);\n}\n\nfunction load(callback) {\n  var window_ = createWindow();\n  var document_ = window_.document;\n  document_.body.innerHTML += LoadDialogTemplate;\n  var input = document_.getElementById('state');\n  var btnLoad = document_.getElementById('load');\n  btnLoad.disabled = true;\n\n  function validateInput() {\n    try {\n      var obj = JSON.parse(input.value);\n\n      if (obj && typeof obj === 'object' && obj !== null) {\n        btnLoad.disabled = false;\n      }\n    } catch (e) {\n      btnLoad.disabled = true;\n    }\n  }\n\n  input.addEventListener('input', function () {\n    validateInput();\n  });\n  document_.getElementById('load').addEventListener('click', function () {\n    var str = input.value;\n    callback(JSON.parse(str).data);\n    window_.close();\n  });\n  var loadFromDisk = document_.getElementById('load-disk');\n  loadFromDisk.addEventListener('change', function () {\n    var reader = new FileReader();\n    reader.addEventListener('loadend', function (e) {\n      input.value = e.target.result;\n      validateInput();\n    });\n    reader.readAsText(loadFromDisk.files[0], 'utf-8');\n  });\n}\n\nmodule.exports = {\n  load: load,\n  save: save\n};","map":{"version":3,"sources":["/Users/roaa/Desktop/demo/node_modules/@brunoimbrizi/controlkit/lib/core/State.js"],"names":["DialogTemplate","SaveDialogTemplate","LoadDialogTemplate","createWindow","width","height","window_","window","open","screenX","innerWidth","screenY","innerHeight","document","documentElement","innerHTML","save","data","document_","body","getElementById","addEventListener","str","value","blob","Blob","type","name","a","createElement","download","webkitURL","href","createObjectURL","style","display","removeChild","appendChild","click","innerText","JSON","stringify","load","callback","input","btnLoad","disabled","validateInput","obj","parse","e","close","loadFromDisk","reader","FileReader","target","result","readAsText","files","module","exports"],"mappings":"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","sourcesContent":["var DialogTemplate =\r\n    '<head>\\n' +\r\n    '   <title>ControlKit State</title>\\n' +\r\n    '   <style type=\"text/css\">\\n' +\r\n    '      body{\\n' +\r\n    '          box-sizing: border-box;\\n' +\r\n    '          padding: 20px;\\n' +\r\n    '          margin: 0;\\n' +\r\n    '          font-family: Arial, sans-serif;\\n' +\r\n    '          width: 100%;\\n' +\r\n    '      }\\n' +\r\n    '      textarea{\\n' +\r\n    '          margin-bottom:10px;\\n' +\r\n    '          box-sizing: border-box;\\n' +\r\n    '          padding: 0;\\n' +\r\n    '          border: 0;\\n' +\r\n    '          border: 1px solid #dedede;\\n' +\r\n    '          outline: none;\\n' +\r\n    '          font-family: Monaco, monospace;\\n' +\r\n    '          font-size: 11px;\\n' +\r\n    '          resize: none;\\n' +\r\n    '          word-wrap: break-word;\\n' +\r\n    '          display: block;\\n' +\r\n    '          width: 100%;\\n' +\r\n    '          overflow-y: scroll;\\n' +\r\n    '          height: 125px;\\n' +\r\n    '      }\\n' +\r\n    '      button{\\n' +\r\n    '          margin: 0;\\n' +\r\n    '          padding: 0 5px 3px 5px;\\n' +\r\n    '          height: 20px;\\n' +\r\n    '      }\\n'+\r\n    '      #save,#filename,#load{\\n' +\r\n    '          float: right;\\n' +\r\n    '      }\\n' +\r\n    '      input[type=\"text\"]{\\n' +\r\n    '          margin: 0;\\n' +\r\n    '          padding: 0;\\n' +\r\n    '          width: 45%;\\n' +\r\n    '          height:20px;\\n' +\r\n    '      }\\n'+\r\n    '   </style>\\n' +\r\n    '</head>\\n' +\r\n    '<body>\\n' +\r\n    '   <textarea name=\"state\" id=\"state\"></textarea>\\n' +\r\n    '</body>';\r\n\r\nvar SaveDialogTemplate =\r\n    '<button type=\"button\" id=\"save\">Save</button>\\n' +\r\n    '<input type=\"text\" id=\"filename\" value=\"ck-state.json\"></input>';\r\n\r\nvar LoadDialogTemplate =\r\n    '<input type=\"file\" id=\"load-disk\"></button>' +\r\n    '<button type=\"button\" id=\"load\">Load</button>';\r\n\r\nfunction createWindow(){\r\n    var width = 320, height = 200;\r\n    var window_ = window.open('','','\\\r\n        width=' + width + ',\\\r\n        height=' + height + ',\\\r\n        left=' + (window.screenX + window.innerWidth * 0.5 - width * 0.5) + ',\\\r\n        top=' + (window.screenY + window.innerHeight * 0.5 - height * 0.5) + ',\\\r\n        location=0,\\\r\n        titlebar=0,\\\r\n        resizable=0');\r\n    window_.document.documentElement.innerHTML = DialogTemplate;\r\n    return window_;\r\n}\r\n\r\nfunction save(data){\r\n    var window_ = createWindow();\r\n    var document_ = window_.document;\r\n        document_.body.innerHTML += SaveDialogTemplate;\r\n        document_.getElementById('save').addEventListener('click',function(){\r\n            //log & save in main window\r\n            var str  = document_.getElementById('state').value,\r\n                blob = new Blob([str],{type:'application:json'}),\r\n                name = document_.getElementById('filename').value;\r\n            var a = document.createElement('a');\r\n            a.download = name;\r\n            if(window.webkitURL){\r\n                a.href = window.webkitURL.createObjectURL(blob);\r\n            } else {\r\n                a.href = window.createObjectURL(blob);\r\n                a.style.display = 'none';\r\n                a.addEventListener('click',function(){\r\n                    document_.body.removeChild(a);\r\n                });\r\n                document_.body.appendChild(a);\r\n            }\r\n            a.click();\r\n        });\r\n    document_.getElementById('state').innerText = JSON.stringify(data);\r\n}\r\n\r\nfunction load(callback){\r\n    var window_ = createWindow();\r\n    var document_ = window_.document;\r\n        document_.body.innerHTML += LoadDialogTemplate;\r\n    var input   = document_.getElementById('state');\r\n    var btnLoad = document_.getElementById('load');\r\n        btnLoad.disabled = true;\r\n\r\n    function validateInput(){\r\n        try{\r\n            var obj = JSON.parse(input.value);\r\n            if(obj && typeof obj === 'object' && obj !== null){\r\n                btnLoad.disabled = false;\r\n            }\r\n        } catch (e){\r\n            btnLoad.disabled = true;\r\n        }\r\n    }\r\n\r\n    input.addEventListener('input',function(){\r\n        validateInput();\r\n    });\r\n    document_.getElementById('load').addEventListener('click',function(){\r\n        var str = input.value;\r\n        callback(JSON.parse(str).data);\r\n        window_.close();\r\n    });\r\n    var loadFromDisk = document_.getElementById('load-disk');\r\n        loadFromDisk.addEventListener('change',function(){\r\n            var reader = new FileReader();\r\n            reader.addEventListener('loadend',function(e){\r\n                input.value = e.target.result;\r\n                validateInput();\r\n            });\r\n            reader.readAsText(loadFromDisk.files[0],'utf-8');\r\n        });\r\n}\r\n\r\nmodule.exports = {\r\n    load : load,\r\n    save : save\r\n};"]},"metadata":{},"sourceType":"script"}