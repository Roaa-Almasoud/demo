{"ast":null,"code":"var Node = require('../core/document/Node'),\n    Group = require('./Group'),\n    ScrollBar = require('../core/layout/ScrollBar');\n\nvar CSS = require('../core/document/CSS');\n\nvar LayoutMode = require('../core/layout/LayoutMode');\n\nvar History = require('../core/History');\n\nvar EventDispatcher = require('../core/event/EventDispatcher'),\n    Event_ = require('../core/event/Event'),\n    DocumentEvent = require('../core/document/DocumentEvent'),\n    NodeEvent = require('../core/document/NodeEvent'),\n    PanelEvent = require('./PanelEvent'),\n    MenuEvent = require('./MenuEvent');\n\nvar Mouse = require('../core/document/Mouse');\n\nvar StringInput = require('../component/StringInput'),\n    NumberInput = require('../component/NumberInput'),\n    Range = require('../component/Range'),\n    Checkbox = require('../component/Checkbox'),\n    Color = require('../component/Color'),\n    Button = require('../component/Button'),\n    Select = require('../component/Select'),\n    Slider = require('../component/Slider'),\n    FunctionPlotter = require('../component/FunctionPlotter'),\n    Pad = require('../component/Pad'),\n    ValuePlotter = require('../component/ValuePlotter'),\n    NumberOutput = require('../component/NumberOutput'),\n    StringOutput = require('../component/StringOutput'),\n    Canvas_ = require('../component/Canvas'),\n    SVG_ = require('../component/SVG');\n\nvar DEFAULT_PANEL_POSITION = null,\n    DEFAULT_PANEL_WIDTH = 200,\n    DEFAULT_PANEL_HEIGHT = null,\n    DEFAULT_PANEL_WIDTH_MIN = 100,\n    DEFAULT_PANEL_WIDTH_MAX = 800,\n    DEFAULT_PANEL_RATIO = 40,\n    DEFAULT_PANEL_LABEL = 'Control Panel',\n    DEFAULT_PANEL_VALIGN = LayoutMode.TOP,\n    DEFAULT_PANEL_ALIGN = LayoutMode.RIGHT,\n    DEFAULT_PANEL_DOCK = {\n  align: LayoutMode.RIGHT,\n  resizable: true\n},\n    DEFAULT_PANEL_ENABLE = true,\n    DEFAULT_PANEL_OPACITY = 1.0,\n    DEFAULT_PANEL_FIXED = true,\n    DEFAULT_PANEL_VCONSTRAIN = true;\n\nfunction Panel(controlKit, params) {\n  EventDispatcher.apply(this, arguments);\n  this._parent = controlKit;\n  params = params || {};\n  params.valign = params.valign || DEFAULT_PANEL_VALIGN;\n  params.align = params.align || DEFAULT_PANEL_ALIGN;\n  params.position = params.position || DEFAULT_PANEL_POSITION;\n  params.width = params.width || DEFAULT_PANEL_WIDTH;\n  params.height = params.height || DEFAULT_PANEL_HEIGHT;\n  params.ratio = params.ratio || DEFAULT_PANEL_RATIO;\n  params.label = params.label || DEFAULT_PANEL_LABEL;\n  params.opacity = params.opacity || DEFAULT_PANEL_OPACITY;\n  params.fixed = params.fixed === undefined ? DEFAULT_PANEL_FIXED : params.fixed;\n  params.enable = params.enable === undefined ? DEFAULT_PANEL_ENABLE : params.enable;\n  params.vconstrain = params.vconstrain === undefined ? DEFAULT_PANEL_VCONSTRAIN : params.vconstrain;\n\n  if (params.dock) {\n    params.dock.align = params.dock.align || DEFAULT_PANEL_DOCK.align;\n    params.dock.resizable = params.dock.resizable || DEFAULT_PANEL_DOCK.resizable;\n  }\n\n  this._width = Math.max(DEFAULT_PANEL_WIDTH_MIN, Math.min(params.width, DEFAULT_PANEL_WIDTH_MAX));\n  this._height = params.height ? Math.max(0, Math.min(params.height, window.innerHeight)) : null;\n  this._fixed = params.fixed;\n  this._dock = params.dock;\n  this._position = params.position;\n  this._vConstrain = params.vconstrain;\n  this._label = params.label;\n  this._enabled = params.enable;\n  this._groups = [];\n  var width = this._width,\n      isFixed = this._fixed,\n      dock = this._dock,\n      position = this._position,\n      label = this._label,\n      align = params.align,\n      opacity = params.opacity;\n  var root = this._node = new Node().setStyleClass(CSS.Panel),\n      head = this._headNode = new Node().setStyleClass(CSS.Head),\n      menu = new Node().setStyleClass(CSS.Menu),\n      labelWrap = new Node().setStyleClass(CSS.Wrap),\n      label_ = new Node(Node.SPAN).setStyleClass(CSS.Label),\n      wrap = this._wrapNode = new Node(Node.DIV).setStyleClass(CSS.Wrap),\n      list = this._listNode = new Node(Node.LIST).setStyleClass(CSS.GroupList);\n  root.setWidth(width);\n  label_.setProperty('innerHTML', label);\n  labelWrap.addChild(label_);\n  head.addChild(menu);\n  head.addChild(labelWrap);\n  wrap.addChild(list);\n  root.addChild(head);\n  root.addChild(wrap);\n  controlKit.getNode().addChild(root);\n\n  if (!dock) {\n    var menuHide = this._menuHide = new Node(Node.INPUT_BUTTON);\n    menuHide.setStyleClass(CSS.ButtonMenuHide);\n    menuHide.addEventListener(NodeEvent.MOUSE_DOWN, this._onMenuHideMouseDown.bind(this));\n    menu.addChild(menuHide);\n\n    if (this._parent.panelsAreClosable()) {\n      var menuClose = new Node(Node.INPUT_BUTTON);\n      menuClose.setStyleClass(CSS.ButtonMenuClose);\n      menuClose.addEventListener(NodeEvent.MOUSE_DOWN, this.disable.bind(this));\n      menu.addChild(menuClose);\n    }\n\n    if (this.hasMaxHeight()) {\n      this._addScrollWrap();\n    }\n\n    if (!isFixed) {\n      if (position) {\n        if (align == LayoutMode.LEFT || align == LayoutMode.TOP || align == LayoutMode.BOTTOM) {\n          root.setPositionGlobal(position[0], position[1]);\n        } else {\n          root.setPositionGlobal(window.innerWidth - width - position[0], position[1]);\n          this._position = root.getPosition();\n        }\n      } else this._position = root.getPosition();\n\n      this._mouseOffset = [0, 0];\n      root.setStyleProperty('position', 'absolute');\n      head.addEventListener(NodeEvent.MOUSE_DOWN, this._onHeadDragStart.bind(this));\n    } else {\n      if (position) {\n        var positionX = position[0],\n            positionY = position[1];\n        if (positionY != 0) root.setPositionY(positionY);\n        if (positionX != 0) if (align == LayoutMode.RIGHT) root.getElement().marginRight = positionX;else root.setPositionX(positionX);\n      }\n\n      root.setStyleProperty('float', align);\n    }\n  } else {\n    var dockAlignment = dock.align;\n\n    if (dockAlignment == LayoutMode.LEFT || dockAlignment == LayoutMode.RIGHT) {\n      align = dockAlignment;\n      this._height = window.innerHeight;\n    }\n\n    if (dockAlignment == LayoutMode.TOP || dockAlignment == LayoutMode.BOTTOM) {}\n    /*\r\n     if(dock.resizable)\r\n     {\r\n     var sizeHandle = new ControlKit.Node(ControlKit.NodeType.DIV);\r\n     sizeHandle.setStyleClass(ControlKit.CSS.SizeHandle);\r\n     rootNode.addChild(sizeHandle);\r\n     }\r\n     */\n\n\n    root.setStyleProperty('float', align);\n  }\n\n  var parent = this._parent;\n  var historyIsEnabled = parent.historyIsEnabled(),\n      statesAreEnabled = parent.statesAreEnabled();\n\n  if (historyIsEnabled || statesAreEnabled) {\n    menu.addChildAt(new Node(), 0).setStyleClass(CSS.Wrap); //.setStyleProperty('display','none');\n  }\n\n  if (historyIsEnabled) {\n    this._menuUndo = menu.getChildAt(0).addChild(new Node(Node.INPUT_BUTTON)).setStyleClass(CSS.ButtonMenuUndo).setProperty('value', History.get().getNumStates()).addEventListener(NodeEvent.MOUSE_DOWN, function () {\n      History.get().popState();\n    });\n    parent.addEventListener(MenuEvent.UPDATE_MENU, this, 'onUpdateMenu');\n  }\n\n  if (statesAreEnabled) {\n    menu.getChildAt(0).addChild(new Node(Node.INPUT_BUTTON)).setStyleClass(CSS.ButtonMenuLoad).setProperty('value', 'Load').addEventListener(NodeEvent.MOUSE_DOWN, function () {\n      controlKit._loadState();\n    });\n    menu.getChildAt(0).addChild(new Node(Node.INPUT_BUTTON)).setStyleClass(CSS.ButtonMenuSave).setProperty('value', 'Save').addEventListener(NodeEvent.MOUSE_DOWN, function () {\n      controlKit._saveState();\n    });\n  }\n\n  if (historyIsEnabled || statesAreEnabled) {\n    head.addEventListener(NodeEvent.MOUSE_OVER, function () {\n      menu.setStyleClass(CSS.MenuActive);\n    });\n    head.addEventListener(NodeEvent.MOUSE_OUT, function () {\n      menu.setStyleClass(CSS.Menu);\n    });\n  }\n\n  if (opacity != 1.0 && opacity != 0.0) {\n    root.setStyleProperty('opacity', opacity);\n  }\n\n  window.addEventListener(DocumentEvent.WINDOW_RESIZE, this._onWindowResize.bind(this));\n\n  this._updateAppearance();\n}\n\nPanel.prototype = Object.create(EventDispatcher.prototype);\nPanel.prototype.constructor = Panel;\n\nPanel.prototype._onMenuHideMouseDown = function () {\n  this._enabled = !this._enabled;\n\n  this._updateAppearance();\n};\n\nPanel.prototype.onUpdateMenu = function () {\n  this._menuUndo.setProperty('value', History.get().getNumStates());\n};\n\nPanel.prototype._onMenuUndoTrigger = function () {\n  History.get().popState();\n};\n\nPanel.prototype._updateAppearance = function () {\n  var rootNode = this._node,\n      headNode = this._headNode,\n      menuHide = this._menuHide;\n\n  if (!this._enabled) {\n    headNode.getStyle().borderBottom = 'none';\n    rootNode.setHeight(headNode.getHeight());\n    menuHide.setStyleClass(CSS.ButtonMenuShow);\n    this.dispatchEvent(new Event_(this, PanelEvent.PANEL_HIDE, null));\n  } else {\n    rootNode.setHeight(headNode.getHeight() + this._wrapNode.getHeight());\n    rootNode.deleteStyleProperty('height');\n    menuHide.setStyleClass(CSS.ButtonMenuHide);\n    headNode.setStyleClass(CSS.Head);\n    this.dispatchEvent(new Event_(this, PanelEvent.PANEL_SHOW, null));\n  }\n};\n\nPanel.prototype._onHeadDragStart = function () {\n  var parentNode = this._parent.getNode(),\n      node = this._node;\n\n  var nodePos = node.getPositionGlobal(),\n      mousePos = Mouse.get().getPosition(),\n      offsetPos = this._mouseOffset;\n  offsetPos[0] = mousePos[0] - nodePos[0];\n  offsetPos[1] = mousePos[1] - nodePos[1];\n  var eventMouseMove = DocumentEvent.MOUSE_MOVE,\n      eventMouseUp = DocumentEvent.MOUSE_UP;\n  var self = this;\n\n  var onDrag = function onDrag() {\n    self._updatePosition();\n  },\n      onDragEnd = function onDragEnd() {\n    document.removeEventListener(eventMouseMove, onDrag, false);\n    document.removeEventListener(eventMouseUp, onDragEnd, false);\n    self.dispatchEvent(new Event_(this, PanelEvent.PANEL_MOVE_END, null));\n  };\n\n  parentNode.removeChild(node);\n  parentNode.addChild(node);\n  document.addEventListener(eventMouseMove, onDrag, false);\n  document.addEventListener(eventMouseUp, onDragEnd, false);\n  this.dispatchEvent(new Event_(this, PanelEvent.PANEL_MOVE_BEGIN, null));\n};\n\nPanel.prototype._updatePosition = function () {\n  var mousePos = Mouse.get().getPosition(),\n      offsetPos = this._mouseOffset;\n  var position = this._position;\n  position[0] = mousePos[0] - offsetPos[0];\n  position[1] = mousePos[1] - offsetPos[1];\n\n  this._constrainHeight();\n\n  this._constrainPosition();\n\n  this.dispatchEvent(new Event_(this, PanelEvent.PANEL_MOVE, null));\n};\n\nPanel.prototype._onWindowResize = function () {\n  if (this.isDocked()) {\n    var dock = this._dock;\n\n    if (dock.align == LayoutMode.RIGHT || dock.align == LayoutMode.LEFT) {\n      var windowHeight = window.innerHeight,\n          listHeight = this._listNode.getHeight(),\n          headHeight = this._headNode.getHeight();\n\n      this._height = windowHeight;\n\n      if (windowHeight - headHeight > listHeight) {\n        this._scrollBar.disable();\n      } else {\n        this._scrollBar.enable();\n      }\n\n      this.dispatchEvent(new Event_(this, PanelEvent.PANEL_SIZE_CHANGE));\n    }\n  } else {\n    if (!this.isFixed()) {\n      this._constrainPosition();\n    }\n  }\n\n  this._constrainHeight();\n\n  this.dispatchEvent(new Event_(this, DocumentEvent.WINDOW_RESIZE));\n};\n\nPanel.prototype._constrainPosition = function () {\n  var node = this._node;\n  var maxX = window.innerWidth - node.getWidth(),\n      maxY = window.innerHeight - node.getHeight();\n  var position = this._position;\n  position[0] = Math.max(0, Math.min(position[0], maxX));\n  position[1] = Math.max(0, Math.min(position[1], maxY));\n  node.setPositionGlobal(position[0], position[1]);\n};\n\nPanel.prototype._constrainHeight = function () {\n  if (!this._vConstrain) return;\n  var hasMaxHeight = this.hasMaxHeight(),\n      hasScrollWrap = this.hasScrollWrap();\n  var head = this._headNode,\n      wrap = this._wrapNode;\n  var scrollBar = this._scrollBar;\n  var panelTop = this.isDocked() ? 0 : this.isFixed() ? 0 : this._position[1];\n  var panelHeight = hasMaxHeight ? this.getMaxHeight() : hasScrollWrap ? scrollBar.getTargetNode().getHeight() : wrap.getHeight();\n  var panelBottom = panelTop + panelHeight;\n  var headHeight = head.getHeight();\n  var windowHeight = window.innerHeight,\n      heightDiff = windowHeight - panelBottom - headHeight,\n      heightSum;\n\n  if (heightDiff < 0.0) {\n    heightSum = panelHeight + heightDiff;\n\n    if (!hasScrollWrap) {\n      this._addScrollWrap(heightSum);\n\n      this.dispatchEvent(new Event_(this, PanelEvent.PANEL_SCROLL_WRAP_ADDED, null));\n      return;\n    }\n\n    scrollBar.setWrapHeight(heightSum);\n    wrap.setHeight(heightSum);\n  } else {\n    if (!hasMaxHeight && hasScrollWrap) {\n      scrollBar.removeFromParent();\n      wrap.addChild(this._listNode);\n      wrap.deleteStyleProperty('height');\n\n      this._scrollBar.removeMouseListener();\n\n      this._scrollBar = null;\n      this.dispatchEvent(new Event_(this, PanelEvent.PANEL_SCROLL_WRAP_REMOVED, null));\n    }\n  }\n};\n\nPanel.prototype.onGroupListSizeChange = function () {\n  if (this.hasScrollWrap()) {\n    this._updateScrollWrap();\n  }\n\n  this._constrainHeight();\n};\n\nPanel.prototype._updateScrollWrap = function () {\n  var wrap = this._wrapNode,\n      scrollBar = this._scrollBar,\n      height = this.hasMaxHeight() ? this.getMaxHeight() : 100,\n      listHeight = this._listNode.getHeight();\n\n  wrap.setHeight(listHeight < height ? listHeight : height);\n  scrollBar.update();\n\n  if (!scrollBar.isValid()) {\n    scrollBar.disable();\n    wrap.setHeight(wrap.getChildAt(1).getHeight());\n  } else {\n    scrollBar.enable();\n    wrap.setHeight(height);\n  }\n};\n\nPanel.prototype._addScrollWrap = function () {\n  var wrapNode = this._wrapNode,\n      listNode = this._listNode,\n      height = arguments.length == 0 ? this.getMaxHeight() : arguments[0];\n  this._scrollBar = new ScrollBar(wrapNode, listNode, height);\n\n  if (this.isEnabled()) {\n    wrapNode.setHeight(height);\n  }\n};\n\nPanel.prototype.hasScrollWrap = function () {\n  return this._scrollBar != null;\n};\n\nPanel.prototype.preventSelectDrag = function () {\n  if (!this.hasScrollWrap()) {\n    return;\n  }\n\n  this._wrapNode.getElement().scrollTop = 0;\n};\n\nPanel.prototype.enable = function () {\n  this._node.setStyleProperty('display', 'block');\n\n  this._enabled = true;\n\n  this._updateAppearance();\n};\n\nPanel.prototype.disable = function () {\n  this._node.setStyleProperty('display', 'none');\n\n  this._enabled = false;\n\n  this._updateAppearance();\n};\n\nPanel.prototype.isEnabled = function () {\n  return this._enabled;\n};\n\nPanel.prototype.isDisabled = function () {\n  return !this._enabled;\n};\n\nPanel.prototype.hasMaxHeight = function () {\n  return this._height != null;\n};\n\nPanel.prototype.getMaxHeight = function () {\n  return this._height;\n};\n\nPanel.prototype.isDocked = function () {\n  return this._dock;\n};\n\nPanel.prototype.isFixed = function () {\n  return this._fixed;\n};\n\nPanel.prototype.getGroups = function () {\n  return this._groups;\n};\n\nPanel.prototype.getNode = function () {\n  return this._node;\n};\n\nPanel.prototype.getList = function () {\n  return this._listNode;\n};\n\nPanel.prototype.getWidth = function () {\n  return this._width;\n};\n\nPanel.prototype.getPosition = function () {\n  return this._position;\n};\n\nPanel.prototype.getParent = function () {\n  return this._parent;\n};\n/**\r\n * Adds a new Group to the Panel.\r\n * @param {Object} [params] - Group options\r\n * @param {String} [params.label=''] - The Group label string\r\n * @param {Boolean} [params.useLabel=true] - Trigger whether all contained SubGroups and Components should use labels\r\n * @param {Boolean} [params.enable=true] - Defines initial state open / closed\r\n * @param {Number} [params.height=null] - Defines if the height of the Group should be constrained to certain height\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addGroup = function (params) {\n  var group = new Group(this, params);\n\n  this._groups.push(group);\n\n  if (this.isDocked()) {\n    this.dispatchEvent(new Event_(this, PanelEvent.PANEL_SIZE_CHANGE));\n  }\n\n  return this;\n};\n/**\r\n * Removes a Group from the Panel.\r\n * @param {Object} [group] - Group\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.removeGroup = function (group) {\n  var index = this._groups.findIndex(function (element) {\n    return element === group;\n  });\n\n  if (index < 0) return this;\n  var list = this.getNode().getLastChild().getFirstChild();\n\n  var _group = this._groups.splice(index, 1)[0];\n\n  list.removeChild(_group._node);\n\n  if (this.isDocked()) {\n    this.dispatchEvent(new Event_(this, PanelEvent.PANEL_SIZE_CHANGE));\n  }\n\n  return this;\n};\n/**\r\n * Adds a new SubGroup to the last added Group.\r\n * @param {Object} [params] - SubGroup options\r\n * @param {String} [params.label=''] - The SubGroup label string\r\n * @param {Boolean} [params.useLabel=true] - Trigger whether all Components should use labels\r\n * @param {Boolean} [params.enable=true] - Defines initial state open / closed\r\n * @param {Number} [params.height=null] - Defines if the height of the SubGroup should be constrained to certain height\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addSubGroup = function (params) {\n  var groups = this._groups;\n\n  if (groups.length == 0) {\n    this.addGroup();\n  }\n\n  groups[groups.length - 1].addSubGroup(params);\n  return this;\n};\n\nPanel.prototype._addComponent = function () {\n  var groups = this._groups,\n      group;\n\n  if (groups.length == 0) {\n    groups.push(new Group(this));\n  }\n\n  group = groups[groups.length - 1];\n  group.addComponent.apply(group, arguments);\n  return this;\n};\n/**\r\n * Adds a new StringInput to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - StringInput options\r\n * @param {String} [params.label=value] - StringInput label\r\n * @param {Function} [params.onChange] - Callback on change\r\n * @param {Array} [params.presets] - A set of presets\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addStringInput = function (object, value, params) {\n  return this._addComponent(StringInput, object, value, params);\n};\n/**\r\n * Adds a new NumberInput to last added SubGroup.\r\n * @param {Object} object - The object.\r\n * @param {String} value - The property key.\r\n * @param {Object} [params] - Component options.\r\n * @param {String} [params.label=value] - NumberInput label\r\n * @param {Function} [params.onChange] - Callback on change\r\n * @param {Number} [params.step] - Amount subbed/added on arrowDown/arrowUp press\r\n * @param {Number} [params.dp] - Decimal places displayed\r\n * @param {Array} [params.presets] - A set of presets\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addNumberInput = function (object, value, params) {\n  return this._addComponent(NumberInput, object, value, params);\n};\n/**\r\n * Adds a new Range input to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Range label\r\n * @param {Function} [params.onChange] - Callback on change\r\n * @param {Number} [params.step] - Amount subbed/added on arrowDown/arrowUp press\r\n * @param {Number} [params.dp] - Decimal places displayed\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addRange = function (object, value, params) {\n  return this._addComponent(Range, object, value, params);\n};\n/**\r\n * Adds a new Checkbox to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Checkbox label\r\n * @param {Function} [params.onChange] - Callback on change\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addCheckbox = function (object, value, params) {\n  return this._addComponent(Checkbox, object, value, params);\n};\n/**\r\n * Adds a new Color modifier to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Color label\r\n * @param {Function} [params.onChange] - Callback on change\r\n * @param {String} [params.colorMode='rgb'] - The colorMode to be used: 'hex' #ff00ff, 'rgb' [255,0,255], 'rgbfv' [1,0,1]\r\n * @param {Array} [params.presets] - A set of preset colors matching params.colorMode\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addColor = function (object, value, params) {\n  return this._addComponent(Color, object, value, params);\n};\n/**\r\n * Adds a new Button to last added SubGroup.\r\n * @param {String} label - The object\r\n * @param {Function} onPress - Callback\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Button label\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addButton = function (label, onPress, params) {\n  return this._addComponent(Button, label, onPress, params);\n};\n/**\r\n * Adds a new Select to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Button label\r\n * @param {Function} [params.onChange] - Callback on change - function(index){}\r\n * @param {String} [params.target] - The property to be set on select\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addSelect = function (object, value, params) {\n  return this._addComponent(Select, object, value, params);\n};\n/**\r\n * Adds a new Slider to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {String} range - The min/max array key to be used\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Slider label\r\n * @param {Function} [params.onChange] - Callback on change\r\n * @param {Function} [params.onFinish] - Callback on finish\r\n * @param {Number} [params.step] - Amount subbed/added on arrowDown/arrowUp press inside the input\r\n * @param {Number} [params.dp] - Decimal places displayed\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addSlider = function (object, value, range, params) {\n  return this._addComponent(Slider, object, value, range, params);\n};\n/**\r\n * Adds a new FunctionPlotter to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key - f(x), f(x,y)\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - FunctionPlotter label\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addFunctionPlotter = function (object, value, params) {\n  return this._addComponent(FunctionPlotter, object, value, params);\n};\n/**\r\n * Adds a new XY-Pad to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Pad label\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addPad = function (object, value, params) {\n  return this._addComponent(Pad, object, value, params);\n};\n/**\r\n * Adds a new ValuePlotter to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Plotter label\r\n * @param {Number} [params.height] - Plotter height\r\n * @param {Number} [params.resolution] - Graph resolution\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addValuePlotter = function (object, value, params) {\n  return this._addComponent(ValuePlotter, object, value, params);\n};\n/**\r\n * Adds a new NumberOutput to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Output label\r\n * @param {Number} [params.dp] - Decimal places displayed\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addNumberOutput = function (object, value, params) {\n  return this._addComponent(NumberOutput, object, value, params);\n};\n/**\r\n * Adds a new StringOutput to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Output label\r\n * @returns {Panel}\r\n */\n\n\nPanel.prototype.addStringOutput = function (object, value, params) {\n  return this._addComponent(StringOutput, object, value, params);\n};\n\nPanel.prototype.addCanvas = function (params) {\n  return this._addComponent(Canvas_, params);\n};\n\nPanel.prototype.addSVG = function (params) {\n  return this._addComponent(SVG_, params);\n};\n\nPanel.prototype.setData = function (data) {\n  var groups = this._groups,\n      i = -1,\n      l = groups.length;\n\n  while (++i < l) {\n    groups[i].setData(data[i]);\n  }\n};\n\nPanel.prototype.getData = function () {\n  var groups = this._groups,\n      i = -1,\n      l = groups.length;\n  var data = [];\n\n  while (++i < l) {\n    data.push(groups[i].getData());\n  }\n\n  return data;\n};\n\nmodule.exports = Panel;","map":{"version":3,"sources":["/Users/roaa/Desktop/demo/node_modules/@brunoimbrizi/controlkit/lib/group/Panel.js"],"names":["Node","require","Group","ScrollBar","CSS","LayoutMode","History","EventDispatcher","Event_","DocumentEvent","NodeEvent","PanelEvent","MenuEvent","Mouse","StringInput","NumberInput","Range","Checkbox","Color","Button","Select","Slider","FunctionPlotter","Pad","ValuePlotter","NumberOutput","StringOutput","Canvas_","SVG_","DEFAULT_PANEL_POSITION","DEFAULT_PANEL_WIDTH","DEFAULT_PANEL_HEIGHT","DEFAULT_PANEL_WIDTH_MIN","DEFAULT_PANEL_WIDTH_MAX","DEFAULT_PANEL_RATIO","DEFAULT_PANEL_LABEL","DEFAULT_PANEL_VALIGN","TOP","DEFAULT_PANEL_ALIGN","RIGHT","DEFAULT_PANEL_DOCK","align","resizable","DEFAULT_PANEL_ENABLE","DEFAULT_PANEL_OPACITY","DEFAULT_PANEL_FIXED","DEFAULT_PANEL_VCONSTRAIN","Panel","controlKit","params","apply","arguments","_parent","valign","position","width","height","ratio","label","opacity","fixed","undefined","enable","vconstrain","dock","_width","Math","max","min","_height","window","innerHeight","_fixed","_dock","_position","_vConstrain","_label","_enabled","_groups","isFixed","root","_node","setStyleClass","head","_headNode","Head","menu","Menu","labelWrap","Wrap","label_","SPAN","Label","wrap","_wrapNode","DIV","list","_listNode","LIST","GroupList","setWidth","setProperty","addChild","getNode","menuHide","_menuHide","INPUT_BUTTON","ButtonMenuHide","addEventListener","MOUSE_DOWN","_onMenuHideMouseDown","bind","panelsAreClosable","menuClose","ButtonMenuClose","disable","hasMaxHeight","_addScrollWrap","LEFT","BOTTOM","setPositionGlobal","innerWidth","getPosition","_mouseOffset","setStyleProperty","_onHeadDragStart","positionX","positionY","setPositionY","getElement","marginRight","setPositionX","dockAlignment","parent","historyIsEnabled","statesAreEnabled","addChildAt","_menuUndo","getChildAt","ButtonMenuUndo","get","getNumStates","popState","UPDATE_MENU","ButtonMenuLoad","_loadState","ButtonMenuSave","_saveState","MOUSE_OVER","MenuActive","MOUSE_OUT","WINDOW_RESIZE","_onWindowResize","_updateAppearance","prototype","Object","create","constructor","onUpdateMenu","_onMenuUndoTrigger","rootNode","headNode","getStyle","borderBottom","setHeight","getHeight","ButtonMenuShow","dispatchEvent","PANEL_HIDE","deleteStyleProperty","PANEL_SHOW","parentNode","node","nodePos","getPositionGlobal","mousePos","offsetPos","eventMouseMove","MOUSE_MOVE","eventMouseUp","MOUSE_UP","self","onDrag","_updatePosition","onDragEnd","document","removeEventListener","PANEL_MOVE_END","removeChild","PANEL_MOVE_BEGIN","_constrainHeight","_constrainPosition","PANEL_MOVE","isDocked","windowHeight","listHeight","headHeight","_scrollBar","PANEL_SIZE_CHANGE","maxX","getWidth","maxY","hasScrollWrap","scrollBar","panelTop","panelHeight","getMaxHeight","getTargetNode","panelBottom","heightDiff","heightSum","PANEL_SCROLL_WRAP_ADDED","setWrapHeight","removeFromParent","removeMouseListener","PANEL_SCROLL_WRAP_REMOVED","onGroupListSizeChange","_updateScrollWrap","update","isValid","wrapNode","listNode","length","isEnabled","preventSelectDrag","scrollTop","isDisabled","getGroups","getList","getParent","addGroup","group","push","removeGroup","index","findIndex","element","getLastChild","getFirstChild","_group","splice","addSubGroup","groups","_addComponent","addComponent","addStringInput","object","value","addNumberInput","addRange","addCheckbox","addColor","addButton","onPress","addSelect","addSlider","range","addFunctionPlotter","addPad","addValuePlotter","addNumberOutput","addStringOutput","addCanvas","addSVG","setData","data","i","l","getData","module","exports"],"mappings":"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","sourcesContent":["var Node      = require('../core/document/Node'),\r\n    Group     = require('./Group'),\r\n    ScrollBar = require('../core/layout/ScrollBar');\r\n\r\nvar CSS        = require('../core/document/CSS');\r\nvar LayoutMode = require('../core/layout/LayoutMode');\r\nvar History    = require('../core/History');\r\n\r\nvar EventDispatcher = require('../core/event/EventDispatcher'),\r\n    Event_          = require('../core/event/Event'),\r\n    DocumentEvent   = require('../core/document/DocumentEvent'),\r\n    NodeEvent       = require('../core/document/NodeEvent'),\r\n    PanelEvent      = require('./PanelEvent'),\r\n    MenuEvent       = require('./MenuEvent');\r\n\r\nvar Mouse = require('../core/document/Mouse');\r\n\r\nvar StringInput     = require('../component/StringInput'),\r\n    NumberInput     = require('../component/NumberInput'),\r\n    Range           = require('../component/Range'),\r\n    Checkbox        = require('../component/Checkbox'),\r\n    Color           = require('../component/Color'),\r\n    Button          = require('../component/Button'),\r\n    Select          = require('../component/Select'),\r\n    Slider          = require('../component/Slider'),\r\n    FunctionPlotter = require('../component/FunctionPlotter'),\r\n    Pad             = require('../component/Pad'),\r\n    ValuePlotter    = require('../component/ValuePlotter'),\r\n    NumberOutput    = require('../component/NumberOutput'),\r\n    StringOutput    = require('../component/StringOutput'),\r\n    Canvas_         = require('../component/Canvas'),\r\n    SVG_            = require('../component/SVG');\r\n\r\nvar DEFAULT_PANEL_POSITION = null,\r\n    DEFAULT_PANEL_WIDTH      = 200,\r\n    DEFAULT_PANEL_HEIGHT     = null,\r\n    DEFAULT_PANEL_WIDTH_MIN  = 100,\r\n    DEFAULT_PANEL_WIDTH_MAX  = 800,\r\n    DEFAULT_PANEL_RATIO      = 40,\r\n    DEFAULT_PANEL_LABEL      = 'Control Panel',\r\n    DEFAULT_PANEL_VALIGN     = LayoutMode.TOP,\r\n    DEFAULT_PANEL_ALIGN      = LayoutMode.RIGHT,\r\n    DEFAULT_PANEL_DOCK       = {align:LayoutMode.RIGHT,resizable:true},\r\n    DEFAULT_PANEL_ENABLE     = true,\r\n    DEFAULT_PANEL_OPACITY    = 1.0,\r\n    DEFAULT_PANEL_FIXED      = true,\r\n    DEFAULT_PANEL_VCONSTRAIN = true;\r\n\r\nfunction Panel(controlKit,params){\r\n    EventDispatcher.apply(this,arguments);\r\n    this._parent = controlKit;\r\n\r\n\r\n    params            = params           || {};\r\n    params.valign     = params.valign    || DEFAULT_PANEL_VALIGN;\r\n    params.align      = params.align     || DEFAULT_PANEL_ALIGN;\r\n    params.position   = params.position  || DEFAULT_PANEL_POSITION;\r\n    params.width      = params.width     || DEFAULT_PANEL_WIDTH;\r\n    params.height     = params.height    || DEFAULT_PANEL_HEIGHT;\r\n    params.ratio      = params.ratio     || DEFAULT_PANEL_RATIO;\r\n    params.label      = params.label     || DEFAULT_PANEL_LABEL;\r\n    params.opacity    = params.opacity   || DEFAULT_PANEL_OPACITY;\r\n    params.fixed      = params.fixed      === undefined ? DEFAULT_PANEL_FIXED      : params.fixed;\r\n    params.enable     = params.enable     === undefined ? DEFAULT_PANEL_ENABLE     : params.enable;\r\n    params.vconstrain = params.vconstrain === undefined ? DEFAULT_PANEL_VCONSTRAIN : params.vconstrain;\r\n\r\n    if (params.dock) {\r\n        params.dock.align = params.dock.align || DEFAULT_PANEL_DOCK.align;\r\n        params.dock.resizable = params.dock.resizable || DEFAULT_PANEL_DOCK.resizable;\r\n    }\r\n\r\n    this._width      = Math.max(DEFAULT_PANEL_WIDTH_MIN,\r\n                       Math.min(params.width,DEFAULT_PANEL_WIDTH_MAX));\r\n    this._height     = params.height ?  Math.max(0,Math.min(params.height,window.innerHeight)) : null;\r\n    this._fixed      = params.fixed;\r\n    this._dock       = params.dock;\r\n    this._position   = params.position;\r\n    this._vConstrain = params.vconstrain;\r\n    this._label      = params.label;\r\n    this._enabled    = params.enable;\r\n    this._groups     = [];\r\n\r\n\r\n    var width    = this._width,\r\n        isFixed  = this._fixed,\r\n        dock     = this._dock,\r\n        position = this._position,\r\n        label    = this._label,\r\n        align    = params.align,\r\n        opacity  = params.opacity;\r\n\r\n\r\n    var root = this._node     = new Node().setStyleClass(CSS.Panel),\r\n        head = this._headNode = new Node().setStyleClass(CSS.Head),\r\n        menu      = new Node().setStyleClass(CSS.Menu),\r\n        labelWrap = new Node().setStyleClass(CSS.Wrap),\r\n        label_    = new Node(Node.SPAN).setStyleClass(CSS.Label),\r\n        wrap = this._wrapNode = new Node(Node.DIV).setStyleClass(CSS.Wrap),\r\n        list = this._listNode = new Node(Node.LIST).setStyleClass(CSS.GroupList);\r\n\r\n    root.setWidth(width);\r\n    label_.setProperty('innerHTML', label);\r\n\r\n    labelWrap.addChild(label_);\r\n    head.addChild(menu);\r\n    head.addChild(labelWrap);\r\n    wrap.addChild(list);\r\n    root.addChild(head);\r\n    root.addChild(wrap);\r\n\r\n    controlKit.getNode().addChild(root);\r\n\r\n\r\n    if (!dock) {\r\n        var menuHide = this._menuHide = new Node(Node.INPUT_BUTTON);\r\n            menuHide.setStyleClass(CSS.ButtonMenuHide);\r\n            menuHide.addEventListener(NodeEvent.MOUSE_DOWN, this._onMenuHideMouseDown.bind(this));\r\n\r\n        menu.addChild(menuHide);\r\n\r\n        if (this._parent.panelsAreClosable()) {\r\n            var menuClose = new Node(Node.INPUT_BUTTON);\r\n            menuClose.setStyleClass(CSS.ButtonMenuClose);\r\n            menuClose.addEventListener(NodeEvent.MOUSE_DOWN, this.disable.bind(this));\r\n\r\n            menu.addChild(menuClose);\r\n        }\r\n\r\n\r\n        if (this.hasMaxHeight()) {\r\n            this._addScrollWrap();\r\n        }\r\n\r\n        if (!isFixed) {\r\n            if (position) {\r\n                if (align == LayoutMode.LEFT ||\r\n                    align == LayoutMode.TOP ||\r\n                    align == LayoutMode.BOTTOM) {\r\n                    root.setPositionGlobal(position[0], position[1]);\r\n                }\r\n                else {\r\n                    root.setPositionGlobal(window.innerWidth - width - position[0], position[1]);\r\n                    this._position = root.getPosition();\r\n                }\r\n            }\r\n            else this._position = root.getPosition();\r\n\r\n            this._mouseOffset = [0, 0];\r\n\r\n            root.setStyleProperty('position', 'absolute');\r\n            head.addEventListener(NodeEvent.MOUSE_DOWN, this._onHeadDragStart.bind(this));\r\n        }\r\n        else {\r\n            if (position) {\r\n                var positionX = position[0],\r\n                    positionY = position[1];\r\n\r\n                if (positionY != 0)root.setPositionY(positionY);\r\n                if (positionX != 0)if (align == LayoutMode.RIGHT)root.getElement().marginRight = positionX;\r\n                else root.setPositionX(positionX);\r\n            }\r\n\r\n            root.setStyleProperty('float', align);\r\n        }\r\n    }\r\n    else {\r\n        var dockAlignment = dock.align;\r\n\r\n        if (dockAlignment == LayoutMode.LEFT ||\r\n            dockAlignment == LayoutMode.RIGHT) {\r\n            align = dockAlignment;\r\n            this._height = window.innerHeight;\r\n        }\r\n\r\n        if (dockAlignment == LayoutMode.TOP ||\r\n            dockAlignment == LayoutMode.BOTTOM) {\r\n\r\n        }\r\n\r\n        /*\r\n         if(dock.resizable)\r\n         {\r\n         var sizeHandle = new ControlKit.Node(ControlKit.NodeType.DIV);\r\n         sizeHandle.setStyleClass(ControlKit.CSS.SizeHandle);\r\n         rootNode.addChild(sizeHandle);\r\n         }\r\n         */\r\n\r\n        root.setStyleProperty('float', align);\r\n    }\r\n\r\n    var parent = this._parent;\r\n    var historyIsEnabled = parent.historyIsEnabled(),\r\n        statesAreEnabled = parent.statesAreEnabled();\r\n\r\n    if(historyIsEnabled || statesAreEnabled){\r\n        menu.addChildAt(new Node(),0).setStyleClass(CSS.Wrap);//.setStyleProperty('display','none');\r\n    }\r\n\r\n    if (historyIsEnabled) {\r\n        this._menuUndo = menu.getChildAt(0)\r\n            .addChild(new Node(Node.INPUT_BUTTON))\r\n                .setStyleClass(CSS.ButtonMenuUndo)\r\n                .setProperty('value',History.get().getNumStates())\r\n                .addEventListener(NodeEvent.MOUSE_DOWN,function(){\r\n                    History.get().popState();\r\n                });\r\n        parent.addEventListener(MenuEvent.UPDATE_MENU,this, 'onUpdateMenu');\r\n    }\r\n    if(statesAreEnabled){\r\n        menu.getChildAt(0)\r\n            .addChild(new Node(Node.INPUT_BUTTON))\r\n                .setStyleClass(CSS.ButtonMenuLoad)\r\n                .setProperty('value','Load')\r\n                .addEventListener(NodeEvent.MOUSE_DOWN,function(){\r\n                    controlKit._loadState();\r\n                });\r\n        menu.getChildAt(0)\r\n            .addChild(new Node(Node.INPUT_BUTTON))\r\n                .setStyleClass(CSS.ButtonMenuSave)\r\n                .setProperty('value','Save')\r\n                .addEventListener(NodeEvent.MOUSE_DOWN,function(){\r\n                    controlKit._saveState();\r\n                });\r\n    }\r\n    if(historyIsEnabled || statesAreEnabled){\r\n        head.addEventListener(NodeEvent.MOUSE_OVER,function(){\r\n            menu.setStyleClass(CSS.MenuActive);\r\n        });\r\n        head.addEventListener(NodeEvent.MOUSE_OUT,function(){\r\n            menu.setStyleClass(CSS.Menu);\r\n        });\r\n    }\r\n    if (opacity != 1.0 && opacity != 0.0) {\r\n        root.setStyleProperty('opacity', opacity);\r\n    }\r\n    window.addEventListener(DocumentEvent.WINDOW_RESIZE,this._onWindowResize.bind(this));\r\n    this._updateAppearance();\r\n}\r\nPanel.prototype = Object.create(EventDispatcher.prototype);\r\nPanel.prototype.constructor = Panel;\r\n\r\nPanel.prototype._onMenuHideMouseDown = function () {\r\n    this._enabled = !this._enabled;\r\n    this._updateAppearance();\r\n};\r\n\r\nPanel.prototype.onUpdateMenu = function () {\r\n    this._menuUndo.setProperty('value', History.get().getNumStates());\r\n};\r\n\r\nPanel.prototype._onMenuUndoTrigger = function () {\r\n    History.get().popState();\r\n};\r\n\r\n\r\nPanel.prototype._updateAppearance = function () {\r\n    var rootNode = this._node,\r\n        headNode = this._headNode,\r\n        menuHide = this._menuHide;\r\n\r\n    if (!this._enabled) {\r\n        headNode.getStyle().borderBottom = 'none';\r\n        rootNode.setHeight(headNode.getHeight());\r\n        menuHide.setStyleClass(CSS.ButtonMenuShow);\r\n        this.dispatchEvent(new Event_(this, PanelEvent.PANEL_HIDE, null));\r\n    }\r\n    else {\r\n        rootNode.setHeight(headNode.getHeight() + this._wrapNode.getHeight());\r\n        rootNode.deleteStyleProperty('height');\r\n        menuHide.setStyleClass(CSS.ButtonMenuHide);\r\n        headNode.setStyleClass(CSS.Head);\r\n        this.dispatchEvent(new Event_(this, PanelEvent.PANEL_SHOW, null));\r\n    }\r\n};\r\n\r\nPanel.prototype._onHeadDragStart = function(){\r\n    var parentNode = this._parent.getNode(),\r\n        node       = this._node;\r\n\r\n    var nodePos   = node.getPositionGlobal(),\r\n        mousePos  = Mouse.get().getPosition(),\r\n        offsetPos = this._mouseOffset;\r\n\r\n        offsetPos[0] = mousePos[0] - nodePos[0];\r\n        offsetPos[1] = mousePos[1] - nodePos[1];\r\n\r\n    var eventMouseMove = DocumentEvent.MOUSE_MOVE,\r\n        eventMouseUp   = DocumentEvent.MOUSE_UP;\r\n\r\n    var self = this;\r\n\r\n    var onDrag = function () {\r\n            self._updatePosition();\r\n        },\r\n        onDragEnd = function () {\r\n            document.removeEventListener(eventMouseMove, onDrag, false);\r\n            document.removeEventListener(eventMouseUp, onDragEnd, false);\r\n            self.dispatchEvent(new Event_(this, PanelEvent.PANEL_MOVE_END, null));\r\n        };\r\n\r\n    parentNode.removeChild(node);\r\n    parentNode.addChild(   node);\r\n\r\n    document.addEventListener(eventMouseMove, onDrag,    false);\r\n    document.addEventListener(eventMouseUp,   onDragEnd, false);\r\n\r\n    this.dispatchEvent(new Event_(this,PanelEvent.PANEL_MOVE_BEGIN,null));\r\n};\r\n\r\nPanel.prototype._updatePosition = function () {\r\n    var mousePos = Mouse.get().getPosition(),\r\n        offsetPos = this._mouseOffset;\r\n\r\n    var position = this._position;\r\n    position[0] = mousePos[0] - offsetPos[0];\r\n    position[1] = mousePos[1] - offsetPos[1];\r\n\r\n    this._constrainHeight();\r\n    this._constrainPosition();\r\n\r\n    this.dispatchEvent(new Event_(this, PanelEvent.PANEL_MOVE, null));\r\n};\r\n\r\nPanel.prototype._onWindowResize = function () {\r\n    if (this.isDocked()) {\r\n        var dock = this._dock;\r\n\r\n        if (dock.align == LayoutMode.RIGHT ||\r\n            dock.align == LayoutMode.LEFT) {\r\n            var windowHeight = window.innerHeight,\r\n                listHeight = this._listNode.getHeight(),\r\n                headHeight = this._headNode.getHeight();\r\n\r\n            this._height = windowHeight;\r\n\r\n            if ((windowHeight - headHeight) > listHeight){\r\n                this._scrollBar.disable();\r\n            }\r\n            else{\r\n                this._scrollBar.enable();\r\n            }\r\n\r\n            this.dispatchEvent(new Event_(this, PanelEvent.PANEL_SIZE_CHANGE));\r\n        }\r\n    }\r\n    else {\r\n        if (!this.isFixed()){\r\n            this._constrainPosition();\r\n        }\r\n    }\r\n    this._constrainHeight();\r\n    this.dispatchEvent(new Event_(this, DocumentEvent.WINDOW_RESIZE));\r\n};\r\n\r\nPanel.prototype._constrainPosition = function () {\r\n    var node = this._node;\r\n\r\n    var maxX = window.innerWidth - node.getWidth(),\r\n        maxY = window.innerHeight - node.getHeight();\r\n\r\n    var position = this._position;\r\n    position[0] = Math.max(0, Math.min(position[0], maxX));\r\n    position[1] = Math.max(0, Math.min(position[1], maxY));\r\n\r\n    node.setPositionGlobal(position[0], position[1]);\r\n};\r\n\r\nPanel.prototype._constrainHeight = function () {\r\n    if (!this._vConstrain)return;\r\n\r\n    var hasMaxHeight = this.hasMaxHeight(),\r\n        hasScrollWrap = this.hasScrollWrap();\r\n\r\n    var head = this._headNode,\r\n        wrap = this._wrapNode;\r\n\r\n    var scrollBar = this._scrollBar;\r\n\r\n    var panelTop = this.isDocked() ? 0 :\r\n        this.isFixed() ? 0 :\r\n            this._position[1];\r\n\r\n    var panelHeight = hasMaxHeight ? this.getMaxHeight() :\r\n        hasScrollWrap ? scrollBar.getTargetNode().getHeight() :\r\n            wrap.getHeight();\r\n\r\n    var panelBottom = panelTop + panelHeight;\r\n    var headHeight = head.getHeight();\r\n\r\n    var windowHeight = window.innerHeight,\r\n        heightDiff = windowHeight - panelBottom - headHeight,\r\n        heightSum;\r\n\r\n    if (heightDiff < 0.0) {\r\n        heightSum = panelHeight + heightDiff;\r\n\r\n        if (!hasScrollWrap) {\r\n            this._addScrollWrap(heightSum);\r\n            this.dispatchEvent(new Event_(this, PanelEvent.PANEL_SCROLL_WRAP_ADDED, null));\r\n            return;\r\n        }\r\n\r\n        scrollBar.setWrapHeight(heightSum);\r\n        wrap.setHeight(heightSum);\r\n    }\r\n    else {\r\n        if (!hasMaxHeight && hasScrollWrap) {\r\n            scrollBar.removeFromParent();\r\n            wrap.addChild(this._listNode);\r\n            wrap.deleteStyleProperty('height');\r\n            this._scrollBar.removeMouseListener();\r\n            this._scrollBar = null;\r\n\r\n            this.dispatchEvent(new Event_(this, PanelEvent.PANEL_SCROLL_WRAP_REMOVED, null));\r\n        }\r\n    }\r\n};\r\n\r\nPanel.prototype.onGroupListSizeChange = function () {\r\n    if (this.hasScrollWrap()){\r\n        this._updateScrollWrap();\r\n    }\r\n    this._constrainHeight();\r\n};\r\n\r\nPanel.prototype._updateScrollWrap = function () {\r\n    var wrap   = this._wrapNode,\r\n        scrollBar  = this._scrollBar,\r\n        height     = this.hasMaxHeight() ? this.getMaxHeight() : 100,\r\n        listHeight = this._listNode.getHeight();\r\n\r\n    wrap.setHeight(listHeight < height ? listHeight : height);\r\n\r\n    scrollBar.update();\r\n\r\n    if (!scrollBar.isValid()) {\r\n        scrollBar.disable();\r\n        wrap.setHeight(wrap.getChildAt(1).getHeight());\r\n    }\r\n    else {\r\n        scrollBar.enable();\r\n        wrap.setHeight(height);\r\n    }\r\n};\r\n\r\nPanel.prototype._addScrollWrap = function () {\r\n    var wrapNode = this._wrapNode,\r\n        listNode = this._listNode,\r\n        height = arguments.length == 0 ?\r\n            this.getMaxHeight() :\r\n            arguments[0];\r\n\r\n    this._scrollBar = new ScrollBar(wrapNode, listNode, height);\r\n    if (this.isEnabled()){\r\n        wrapNode.setHeight(height);\r\n    }\r\n};\r\n\r\nPanel.prototype.hasScrollWrap = function () {\r\n    return this._scrollBar != null;\r\n};\r\n\r\n\r\nPanel.prototype.preventSelectDrag = function () {\r\n    if (!this.hasScrollWrap()){\r\n        return;\r\n    }\r\n    this._wrapNode.getElement().scrollTop = 0;\r\n};\r\n\r\nPanel.prototype.enable = function () {\r\n    this._node.setStyleProperty('display', 'block');\r\n    this._enabled = true;\r\n    this._updateAppearance();\r\n};\r\n\r\n\r\nPanel.prototype.disable = function () {\r\n    this._node.setStyleProperty('display', 'none');\r\n    this._enabled = false;\r\n    this._updateAppearance();\r\n};\r\n\r\nPanel.prototype.isEnabled = function () {\r\n    return this._enabled;\r\n};\r\n\r\nPanel.prototype.isDisabled = function () {\r\n    return !this._enabled;\r\n};\r\n\r\nPanel.prototype.hasMaxHeight = function () {\r\n    return this._height != null;\r\n};\r\n\r\nPanel.prototype.getMaxHeight = function () {\r\n    return this._height;\r\n};\r\n\r\nPanel.prototype.isDocked = function () {\r\n    return this._dock;\r\n};\r\n\r\nPanel.prototype.isFixed = function () {\r\n    return this._fixed;\r\n};\r\n\r\nPanel.prototype.getGroups = function () {\r\n    return this._groups;\r\n};\r\n\r\nPanel.prototype.getNode = function () {\r\n    return this._node;\r\n};\r\n\r\nPanel.prototype.getList = function () {\r\n    return this._listNode;\r\n};\r\n\r\nPanel.prototype.getWidth = function () {\r\n    return this._width;\r\n};\r\n\r\nPanel.prototype.getPosition = function () {\r\n    return this._position;\r\n};\r\n\r\nPanel.prototype.getParent = function(){\r\n    return this._parent;\r\n};\r\n\r\n/**\r\n * Adds a new Group to the Panel.\r\n * @param {Object} [params] - Group options\r\n * @param {String} [params.label=''] - The Group label string\r\n * @param {Boolean} [params.useLabel=true] - Trigger whether all contained SubGroups and Components should use labels\r\n * @param {Boolean} [params.enable=true] - Defines initial state open / closed\r\n * @param {Number} [params.height=null] - Defines if the height of the Group should be constrained to certain height\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addGroup = function (params) {\r\n    var group = new Group(this, params);\r\n    this._groups.push(group);\r\n    if (this.isDocked()){\r\n        this.dispatchEvent(new Event_(this, PanelEvent.PANEL_SIZE_CHANGE));\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Removes a Group from the Panel.\r\n * @param {Object} [group] - Group\r\n * @returns {Panel}\r\n */\r\nPanel.prototype.removeGroup = function (group) {\r\n    var index = this._groups.findIndex(function(element) { return element === group; });\r\n    if (index < 0) return this;\r\n    \r\n    var list = this.getNode().getLastChild().getFirstChild();\r\n    var _group = this._groups.splice(index, 1)[0];\r\n    list.removeChild(_group._node);\r\n\r\n    if (this.isDocked()){\r\n        this.dispatchEvent(new Event_(this, PanelEvent.PANEL_SIZE_CHANGE));\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Adds a new SubGroup to the last added Group.\r\n * @param {Object} [params] - SubGroup options\r\n * @param {String} [params.label=''] - The SubGroup label string\r\n * @param {Boolean} [params.useLabel=true] - Trigger whether all Components should use labels\r\n * @param {Boolean} [params.enable=true] - Defines initial state open / closed\r\n * @param {Number} [params.height=null] - Defines if the height of the SubGroup should be constrained to certain height\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addSubGroup = function(params){\r\n    var groups = this._groups;\r\n    if(groups.length == 0){\r\n        this.addGroup();\r\n    }\r\n    groups[groups.length - 1].addSubGroup(params);\r\n    return this;\r\n};\r\n\r\nPanel.prototype._addComponent = function(){\r\n    var groups = this._groups,\r\n        group;\r\n    if(groups.length == 0){\r\n        groups.push(new Group(this));\r\n    }\r\n    group = groups[groups.length-1];\r\n\r\n    group.addComponent.apply(group,arguments);\r\n    return this;\r\n};\r\n\r\n/**\r\n * Adds a new StringInput to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - StringInput options\r\n * @param {String} [params.label=value] - StringInput label\r\n * @param {Function} [params.onChange] - Callback on change\r\n * @param {Array} [params.presets] - A set of presets\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addStringInput = function (object, value, params) {\r\n    return this._addComponent(StringInput,object,value,params);\r\n};\r\n\r\n/**\r\n * Adds a new NumberInput to last added SubGroup.\r\n * @param {Object} object - The object.\r\n * @param {String} value - The property key.\r\n * @param {Object} [params] - Component options.\r\n * @param {String} [params.label=value] - NumberInput label\r\n * @param {Function} [params.onChange] - Callback on change\r\n * @param {Number} [params.step] - Amount subbed/added on arrowDown/arrowUp press\r\n * @param {Number} [params.dp] - Decimal places displayed\r\n * @param {Array} [params.presets] - A set of presets\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addNumberInput = function (object, value, params) {\r\n    return this._addComponent(NumberInput,object,value,params);\r\n};\r\n\r\n/**\r\n * Adds a new Range input to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Range label\r\n * @param {Function} [params.onChange] - Callback on change\r\n * @param {Number} [params.step] - Amount subbed/added on arrowDown/arrowUp press\r\n * @param {Number} [params.dp] - Decimal places displayed\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addRange = function (object, value, params) {\r\n    return this._addComponent(Range,object,value,params);\r\n};\r\n\r\n/**\r\n * Adds a new Checkbox to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Checkbox label\r\n * @param {Function} [params.onChange] - Callback on change\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addCheckbox = function (object, value, params) {\r\n    return this._addComponent(Checkbox,object,value,params);\r\n};\r\n\r\n/**\r\n * Adds a new Color modifier to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Color label\r\n * @param {Function} [params.onChange] - Callback on change\r\n * @param {String} [params.colorMode='rgb'] - The colorMode to be used: 'hex' #ff00ff, 'rgb' [255,0,255], 'rgbfv' [1,0,1]\r\n * @param {Array} [params.presets] - A set of preset colors matching params.colorMode\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addColor = function (object, value, params) {\r\n    return this._addComponent(Color,object,value, params);\r\n};\r\n\r\n/**\r\n * Adds a new Button to last added SubGroup.\r\n * @param {String} label - The object\r\n * @param {Function} onPress - Callback\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Button label\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addButton = function (label, onPress, params) {\r\n    return this._addComponent(Button,label,onPress,params);\r\n};\r\n\r\n/**\r\n * Adds a new Select to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Button label\r\n * @param {Function} [params.onChange] - Callback on change - function(index){}\r\n * @param {String} [params.target] - The property to be set on select\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addSelect = function (object, value, params) {\r\n    return this._addComponent(Select,object,value,params);\r\n};\r\n\r\n/**\r\n * Adds a new Slider to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {String} range - The min/max array key to be used\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Slider label\r\n * @param {Function} [params.onChange] - Callback on change\r\n * @param {Function} [params.onFinish] - Callback on finish\r\n * @param {Number} [params.step] - Amount subbed/added on arrowDown/arrowUp press inside the input\r\n * @param {Number} [params.dp] - Decimal places displayed\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addSlider = function (object, value, range, params) {\r\n    return this._addComponent(Slider,object,value,range,params);\r\n};\r\n\r\n/**\r\n * Adds a new FunctionPlotter to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key - f(x), f(x,y)\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - FunctionPlotter label\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addFunctionPlotter = function (object, value, params) {\r\n    return this._addComponent(FunctionPlotter,object,value,params);\r\n};\r\n\r\n/**\r\n * Adds a new XY-Pad to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Pad label\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addPad = function (object, value, params) {\r\n    return this._addComponent(Pad,object,value,params);\r\n};\r\n\r\n/**\r\n * Adds a new ValuePlotter to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Plotter label\r\n * @param {Number} [params.height] - Plotter height\r\n * @param {Number} [params.resolution] - Graph resolution\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addValuePlotter = function (object, value, params) {\r\n    return this._addComponent(ValuePlotter,object,value,params);\r\n};\r\n\r\n/**\r\n * Adds a new NumberOutput to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Output label\r\n * @param {Number} [params.dp] - Decimal places displayed\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addNumberOutput = function (object, value, params) {\r\n    return this._addComponent(NumberOutput,object,value,params);\r\n};\r\n\r\n/**\r\n * Adds a new StringOutput to last added SubGroup.\r\n * @param {Object} object - The object\r\n * @param {String} value - The property key\r\n * @param {Object} [params] - Component options\r\n * @param {String} [params.label=value] - Output label\r\n * @returns {Panel}\r\n */\r\n\r\nPanel.prototype.addStringOutput = function (object, value, params) {\r\n    return this._addComponent(StringOutput,object,value,params);\r\n};\r\n\r\nPanel.prototype.addCanvas = function (params) {\r\n    return this._addComponent(Canvas_,params);\r\n};\r\n\r\nPanel.prototype.addSVG = function (params) {\r\n    return this._addComponent(SVG_,params);\r\n};\r\n\r\nPanel.prototype.setData = function(data){\r\n    var groups = this._groups,\r\n        i = -1, l = groups.length;\r\n    while(++i < l){\r\n        groups[i].setData(data[i]);\r\n    }\r\n};\r\n\r\nPanel.prototype.getData = function(){\r\n    var groups = this._groups,\r\n        i = -1, l = groups.length;\r\n    var data = [];\r\n    while(++i  < l){\r\n        data.push(groups[i].getData());\r\n    }\r\n    return data;\r\n};\r\n\r\nmodule.exports = Panel;"]},"metadata":{},"sourceType":"script"}