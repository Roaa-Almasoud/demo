{"ast":null,"code":"var ObjectComponent = require('../core/ObjectComponent');\n\nvar Node = require('../core/document/Node');\n\nvar CSS = require('../core/document/CSS');\n\nvar Metric = require('./Metric');\n\nvar ScrollBar = require('../core/layout/ScrollBar');\n\nvar Event_ = require('../core/event/Event'),\n    DocumentEvent = require('../core/document/DocumentEvent'),\n    NodeEvent = require('../core/document/NodeEvent'),\n    ComponentEvent = require('../core/ComponentEvent');\n\nvar DEFAULT_HEIGHT = null,\n    DEFAULT_WRAP = false,\n    DEFAULT_UPDATE = true;\n\nfunction Output(parent, object, value, params) {\n  ObjectComponent.apply(this, arguments);\n  params = params || {};\n  params.height = params.height || DEFAULT_HEIGHT;\n  params.wrap = params.wrap === undefined ? DEFAULT_WRAP : params.wrap;\n  params.update = params.update === undefined ? DEFAULT_UPDATE : params.update;\n  this._wrap = params.wrap;\n  this._update = params.update;\n  var textArea = this._textArea = new Node(Node.TEXTAREA),\n      wrap = this._wrapNode,\n      root = this._node;\n  textArea.setProperty('readOnly', true);\n  wrap.addChild(textArea);\n  textArea.addEventListener(NodeEvent.MOUSE_DOWN, this._onInputDragStart.bind(this));\n  this.addEventListener(ComponentEvent.INPUT_SELECT_DRAG, this._parent, 'onComponentSelectDrag');\n\n  if (params.height) {\n    var textAreaWrap = new Node();\n    textAreaWrap.setStyleClass(CSS.TextAreaWrap);\n    textAreaWrap.addChild(textArea);\n    wrap.addChild(textAreaWrap); //FIXME\n\n    var height = this._height = params.height,\n        padding = 4;\n    textArea.setHeight(Math.max(height + padding, Metric.COMPONENT_MIN_HEIGHT));\n    wrap.setHeight(textArea.getHeight());\n    root.setHeight(wrap.getHeight() + padding);\n    this._scrollBar = new ScrollBar(textAreaWrap, textArea, height - padding);\n  }\n\n  if (params.wrap) {\n    textArea.setStyleProperty('white-space', 'pre-wrap');\n  }\n\n  this._prevString = '';\n  this._prevScrollHeight = -1;\n\n  this._setValue();\n}\n\nOutput.prototype = Object.create(ObjectComponent.prototype);\nOutput.prototype.constructor = Output; //Override in subclass\n\nOutput.prototype._setValue = function () {};\n\nOutput.prototype.onValueUpdate = function () {\n  this._setValue();\n};\n\nOutput.prototype.update = function () {\n  if (!this._update) {\n    return;\n  }\n\n  this._setValue();\n}; //Prevent chrome select drag\n\n\nOutput.prototype._onDrag = function () {\n  this.dispatchEvent(new Event_(this, ComponentEvent.INPUT_SELECT_DRAG, null));\n};\n\nOutput.prototype._onDragFinish = function () {\n  this.dispatchEvent(new Event_(this, ComponentEvent.INPUT_SELECT_DRAG, null));\n  document.removeEventListener(DocumentEvent.MOUSE_MOVE, this._onDrag, false);\n  document.removeEventListener(DocumentEvent.MOUSE_MOVE, this._onDragFinish, false);\n};\n\nOutput.prototype._onInputDragStart = function () {\n  this.dispatchEvent(new Event_(this, ComponentEvent.INPUT_SELECT_DRAG, null));\n  document.addEventListener(DocumentEvent.MOUSE_MOVE, this._onDrag.bind(this), false);\n  document.addEventListener(DocumentEvent.MOUSE_UP, this._onDragFinish.bind(this), false);\n};\n\nmodule.exports = Output;","map":{"version":3,"sources":["/Users/roaa/Desktop/demo/node_modules/@brunoimbrizi/controlkit/lib/component/Output.js"],"names":["ObjectComponent","require","Node","CSS","Metric","ScrollBar","Event_","DocumentEvent","NodeEvent","ComponentEvent","DEFAULT_HEIGHT","DEFAULT_WRAP","DEFAULT_UPDATE","Output","parent","object","value","params","apply","arguments","height","wrap","undefined","update","_wrap","_update","textArea","_textArea","TEXTAREA","_wrapNode","root","_node","setProperty","addChild","addEventListener","MOUSE_DOWN","_onInputDragStart","bind","INPUT_SELECT_DRAG","_parent","textAreaWrap","setStyleClass","TextAreaWrap","_height","padding","setHeight","Math","max","COMPONENT_MIN_HEIGHT","getHeight","_scrollBar","setStyleProperty","_prevString","_prevScrollHeight","_setValue","prototype","Object","create","constructor","onValueUpdate","_onDrag","dispatchEvent","_onDragFinish","document","removeEventListener","MOUSE_MOVE","MOUSE_UP","module","exports"],"mappings":"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","sourcesContent":["var ObjectComponent = require('../core/ObjectComponent');\r\nvar Node = require('../core/document/Node');\r\n\r\nvar CSS       = require('../core/document/CSS');\r\nvar Metric    = require('./Metric');\r\nvar ScrollBar = require('../core/layout/ScrollBar');\r\n\r\nvar Event_         = require('../core/event/Event'),\r\n    DocumentEvent  = require('../core/document/DocumentEvent'),\r\n    NodeEvent      = require('../core/document/NodeEvent'),\r\n    ComponentEvent = require('../core/ComponentEvent');\r\n\r\nvar DEFAULT_HEIGHT = null,\r\n    DEFAULT_WRAP   = false,\r\n    DEFAULT_UPDATE = true;\r\n\r\nfunction Output(parent,object,value,params) {\r\n    ObjectComponent.apply(this,arguments);\r\n\r\n    params        = params        || {};\r\n    params.height = params.height || DEFAULT_HEIGHT;\r\n    params.wrap   = params.wrap   === undefined ? DEFAULT_WRAP : params.wrap;\r\n    params.update = params.update === undefined ? DEFAULT_UPDATE : params.update;\r\n\r\n    this._wrap   = params.wrap;\r\n    this._update = params.update;\r\n\r\n    var textArea = this._textArea = new Node(Node.TEXTAREA),\r\n        wrap = this._wrapNode,\r\n        root = this._node;\r\n\r\n        textArea.setProperty('readOnly',true);\r\n        wrap.addChild(textArea);\r\n\r\n        textArea.addEventListener(NodeEvent.MOUSE_DOWN,this._onInputDragStart.bind(this));\r\n        this.addEventListener(ComponentEvent.INPUT_SELECT_DRAG,this._parent,'onComponentSelectDrag');\r\n\r\n\r\n    if(params.height){\r\n        var textAreaWrap = new Node();\r\n            textAreaWrap.setStyleClass(CSS.TextAreaWrap);\r\n            textAreaWrap.addChild(textArea);\r\n            wrap.addChild(textAreaWrap);\r\n\r\n        //FIXME\r\n        var height  = this._height = params.height,\r\n            padding = 4;\r\n\r\n            textArea.setHeight(Math.max(height + padding  ,Metric.COMPONENT_MIN_HEIGHT));\r\n            wrap.setHeight(textArea.getHeight());\r\n            root.setHeight(wrap.getHeight() + padding);\r\n\r\n        this._scrollBar = new ScrollBar(textAreaWrap,textArea,height - padding)\r\n    }\r\n\r\n    if(params.wrap){\r\n        textArea.setStyleProperty('white-space','pre-wrap');\r\n    }\r\n\r\n    this._prevString = '';\r\n    this._prevScrollHeight = -1;\r\n    this._setValue();\r\n}\r\nOutput.prototype = Object.create(ObjectComponent.prototype);\r\nOutput.prototype.constructor = Output;\r\n\r\n//Override in subclass\r\nOutput.prototype._setValue = function () {};\r\n\r\nOutput.prototype.onValueUpdate = function () {\r\n    this._setValue();\r\n};\r\n\r\nOutput.prototype.update = function () {\r\n    if(!this._update){\r\n        return;\r\n    }\r\n    this._setValue();\r\n};\r\n\r\n//Prevent chrome select drag\r\n\r\nOutput.prototype._onDrag = function(){\r\n    this.dispatchEvent(new Event_(this, ComponentEvent.INPUT_SELECT_DRAG, null));\r\n};\r\n\r\nOutput.prototype._onDragFinish = function(){\r\n    this.dispatchEvent(new Event_(this, ComponentEvent.INPUT_SELECT_DRAG, null));\r\n\r\n    document.removeEventListener(DocumentEvent.MOUSE_MOVE, this._onDrag, false);\r\n    document.removeEventListener(DocumentEvent.MOUSE_MOVE, this._onDragFinish, false);\r\n};\r\n\r\nOutput.prototype._onInputDragStart = function() {\r\n    this.dispatchEvent(new Event_(this, ComponentEvent.INPUT_SELECT_DRAG, null));\r\n    document.addEventListener(DocumentEvent.MOUSE_MOVE, this._onDrag.bind(this), false);\r\n    document.addEventListener(DocumentEvent.MOUSE_UP,   this._onDragFinish.bind(this), false);\r\n};\r\n\r\n\r\nmodule.exports = Output;\r\n"]},"metadata":{},"sourceType":"script"}